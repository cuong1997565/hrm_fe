{"remainingRequest":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/babel-loader/lib/index.js!/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/nguyenxuancuong/Sites/hrm_fe/src/views/user/Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/nguyenxuancuong/Sites/hrm_fe/src/views/user/Detail.vue","mtime":1539654451871},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/cache-loader/dist/cjs.js","mtime":1538403001796},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/@babel/runtime/helpers/builtin/es6/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Listting from './Listting';\nimport { mapActions, mapGetters } from 'vuex';\nimport DialogConfirm from '@/components/DialogConfirm';\nexport default {\n  name: 'UserDetail',\n  components: {\n    Listting: Listting,\n    DialogConfirm: DialogConfirm\n  },\n  data: function data() {\n    return {\n      contracts: {\n        user_id: '',\n        status: 0,\n        type: 0,\n        date_sign: null,\n        date_effective: null,\n        date_expiration: null\n      },\n      typeContract: [{\n        name: 'Học việc',\n        value: 0\n      }, {\n        name: 'Cộng tác viên',\n        value: 1\n      }, {\n        name: 'Thử việc',\n        value: 2\n      }, {\n        name: 'Có thời hạn',\n        value: 3\n      }, {\n        name: 'Không thời hạn',\n        value: 4\n      }, {\n        name: 'Khác',\n        value: 5\n      }],\n      statusContract: [{\n        name: 'Tiêu chuẩn',\n        value: 0\n      }, {\n        name: 'Chấm dứt',\n        value: 1\n      }, {\n        name: 'Gia hạn',\n        value: 2\n      }],\n      // tiêu đề của bảng chi nhánh phòng ban , chức vụ\n      headersPosition: [{\n        text: 'Chi nhánh',\n        value: 'branch',\n        sortable: false\n      }, {\n        text: 'Phòng ban',\n        value: 'department',\n        sortable: false\n      }, {\n        text: 'Chức vụ',\n        value: 'position',\n        sortable: false\n      }],\n      // tiêu đề của bảng hợp đồng\n      headersContract: [{\n        text: 'Tên hợp đồng',\n        value: 'title',\n        sortable: false\n      }, {\n        text: '',\n        sortable: false\n      }, {\n        text: 'Loại hợp đồng',\n        value: 'type',\n        sortable: false\n      }, {\n        text: 'Ngày đăng kí',\n        value: 'date_sign',\n        sortable: false\n      }, {\n        text: 'Ngày bắt đầu',\n        value: 'date_effective',\n        sortable: false\n      }, {\n        text: 'Ngày kêt thúc',\n        value: 'date_expiration',\n        sortable: false\n      }, {\n        text: 'Trạng thái',\n        value: 'status',\n        sortable: false\n      }, {\n        text: 'Hành động',\n        value: 'action',\n        sortable: false\n      }],\n      dataViewHeight: 0,\n      dialogEditContract: false,\n      dialogDelete: false,\n      dateSign: false,\n      dateEffective: false,\n      dateExpiration: false,\n      editedIndex: -1,\n      defaultItem: {\n        status: true\n      }\n    };\n  },\n  computed: _objectSpread({\n    // title of form Contract modal\n    formTitle: function formTitle() {\n      return this.editedIndex === -1 ? 'Thêm thông tin' : 'Sửa thông tin';\n    }\n  }, mapGetters('User', ['userDetail'])),\n  watch: {\n    dateSign: function dateSign(val) {\n      var _this = this;\n\n      val && this.$nextTick(function () {\n        return _this.$refs.picker.activePicker = 'YEAR';\n      });\n    },\n    dateEffective: function dateEffective(val) {\n      var _this2 = this;\n\n      val && this.$nextTick(function () {\n        return _this2.$refs.picker.activePicker = 'YEAR';\n      });\n    },\n    dateExpiration: function dateExpiration(val) {\n      var _this3 = this;\n\n      val && this.$nextTick(function () {\n        return _this3.$refs.picker.activePicker = 'YEAR';\n      });\n    },\n    dataUser: function dataUser(val) {\n      this.user = val;\n    }\n  },\n  methods: _objectSpread({}, mapActions(['setMiniDrawer']), mapActions('Contracts', ['createContract', 'updateContract', 'deleteContract']), mapActions('User', ['getUser', 'deleteUser']), mapActions('Dataview', ['removeDataviewEntry']), mapActions(['showNotify']), {\n    removeConfirm: function removeConfirm() {\n      this.dialogDelete = true;\n    },\n    remove: function remove(confirm) {\n      var _this4 = this;\n\n      if (confirm) {\n        this.deleteUser({\n          id: this.$route.params.id,\n          cb: function cb(response) {\n            _this4.removeDataviewEntry({\n              name: 'user',\n              data: _this4.userDetail,\n              key: 'id'\n            });\n\n            _this4.$store.dispatch('showNotify', {\n              text: _this4.$t('alert.success'),\n              color: 'success'\n            });\n\n            _this4.dialogDelete = false;\n\n            _this4.$router.push({\n              name: 'user'\n            });\n          },\n          error: function error(_error) {\n            if (_error.status === 404) {\n              _this4.$store.dispatch('showNotify', {\n                text: _this4.$t('alert.not-found'),\n                color: 'warning'\n              });\n            }\n          }\n        });\n      }\n    },\n    save: function save(date) {\n      this.$refs.dateSign.save(date);\n      this.$refs.dateEffective.save(date);\n      this.$refs.dateExpiration.save(date);\n    },\n    // contract\n    editContract: function editContract(item, id) {\n      this.idContract = id;\n      this.editedIndex = 1;\n      this.contracts = Object.assign({}, item);\n      this.dialogEditContract = true;\n    },\n    addContract: function addContract() {\n      this.contracts = this.contracts;\n      this.dialogEditContract = true;\n    },\n    closeContract: function closeContract() {\n      var _this5 = this;\n\n      this.dialogEditContract = false;\n      setTimeout(function () {\n        if (_this5.editedIndex === -1) {\n          _this5.editedIndex = -1;\n        } else {\n          _this5.contracts = Object.assign({}, _this5.defaultItem);\n          _this5.editedIndex = -1;\n        }\n      }, 300);\n    },\n    submitForm: function submitForm() {\n      var _this6 = this;\n\n      if (this.editedIndex === -1) {\n        this.createContract({\n          contract: this.contracts,\n          cb: function cb(response) {\n            _this6.dialog = false;\n            setTimeout(function () {\n              _this6.contracts = Object.assign({}, _this6.defaultItem);\n              _this6.editedIndex = -1;\n            }, 300);\n\n            _this6.showNotify({\n              color: 'success',\n              text: 'Thành công'\n            });\n\n            _this6.getUser({\n              userId: _this6.$route.params.id,\n              params: {\n                include: 'roles,departments,contracts'\n              }\n            });\n          }\n        });\n      } else {\n        this.updateContract({\n          id: this.idContract,\n          contract: this.contracts,\n          cb: function cb(response) {\n            _this6.showNotify({\n              color: 'success',\n              text: 'Thành công'\n            });\n\n            setTimeout(function () {\n              _this6.contracts = Object.assign({}, _this6.defaultItem);\n              _this6.editedIndex = -1;\n            }, 300);\n\n            _this6.getUser({\n              userId: _this6.$route.params.id,\n              params: {\n                include: 'roles,departments,contracts'\n              }\n            });\n\n            _this6.dialogEditContract = false;\n          }\n        });\n      }\n    },\n    // thời gian đăng kí , có hiệu lực hợp đồng\n    dateConstract: function dateConstract() {\n      var today = new Date();\n      var dd = today.getDate();\n      var mm = today.getMonth() + 1;\n      var yyyy = today.getFullYear();\n\n      if (dd < 10) {\n        dd = '0' + dd;\n      }\n\n      if (mm < 10) {\n        mm = '0' + mm;\n      }\n\n      today = yyyy + '-' + mm + '-' + dd;\n      this.contracts.date_sign = today;\n      this.contracts.date_effective = today;\n    },\n    // thời gian kết thúc hợp đồng\n    dateExpirationConstract: function dateExpirationConstract() {\n      var today = new Date();\n      var dd = today.getDate();\n      var mm = today.getMonth() + 3;\n      var yyyy = today.getFullYear();\n\n      if (dd < 10) {\n        dd = '0' + dd;\n      }\n\n      if (mm < 10) {\n        mm = '0' + mm;\n      }\n\n      today = yyyy + '-' + mm + '-' + dd;\n      this.contracts.date_expiration = today;\n    }\n  }),\n  created: function created() {\n    this.dateExpirationConstract();\n    this.dateConstract();\n    this.setMiniDrawer(true);\n\n    if (!this.userDetail.id) {\n      this.getUser({\n        userId: this.$route.params.id,\n        params: {\n          include: 'roles,departments,contracts'\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.dataViewHeight = this.$refs.laylout.clientHeight - 50;\n  }\n};",{"version":3,"sources":["Detail.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <v-layout ref=\"laylout\" row fill-height>\n   <v-flex xs4>\n    <listting :is-mini=\"true\" />\n  </v-flex>\n  <v-flex xs8 class=\"border-e0-left\">\n    <v-toolbar dense color=\"white\" flat>\n      <v-toolbar-title>{{ $t('title.user.detail') }}: {{userDetail.name}}</v-toolbar-title>\n      <v-spacer></v-spacer>\n      <v-tooltip bottom>\n        <v-btn slot='activator' v-if=\"canAccess('user.update')\" icon @click=\"$router.push({name: 'user-edit', params: {id: $route.params.id}})\">\n          <v-icon>edit</v-icon>\n        </v-btn>\n        <span>Sửa</span>\n      </v-tooltip>\n      <v-tooltip bottom>\n        <v-btn slot=\"activator\" v-if=\"canAccess('user.delete')\" icon @click=\"removeConfirm\">\n          <v-icon>delete</v-icon>\n        </v-btn>\n        <span>Xóa</span>\n      </v-tooltip>\n      <v-tooltip bottom>\n        <v-btn slot=\"activator\" icon @click=\"$router.push({name: 'user'})\">\n          <v-icon>close</v-icon>\n        </v-btn>\n        <span>Đóng</span>\n      </v-tooltip>\n    </v-toolbar>\n    <v-container fluid class=\"white scroll-y border-e0-top\" :style=\"{height: dataViewHeight + 'px'}\">\n      <v-layout row>\n        <v-flex md5 sm5 xs5>\n          <img v-if=\"userDetail.image\" src=\"userDetail.image\" alt=\"\">\n          <img width=\"100%\" src=\"https://demo1.sinnovasoft.com/Content/images/empty.png\" alt=\"\">\n        </v-flex>\n        <v-flex md7 sm7 xs7 style=\"padding-left:10px;\" id=\"info-user\">\n          <p v-if=\"userDetail.code\"> - Mã nhân viên : {{ userDetail.code }}</p>\n          <p v-if=\"userDetail.name\"> - Tên nhân viên : {{ userDetail.name }}</p>\n          <p> - Thư điện tử : {{ userDetail.email }}</p>\n          <p v-if='userDetail.qualification'> - Trình độ chuyên môn : {{ userDetail.qualification }}</p>\n          <p v-if='userDetail.address'> - Địa chỉ : {{ userDetail.address }}</p>\n          <p v-if=\"userDetail.phone\"> - Số điện thoại: {{ userDetail.phone }}</p>\n          <p v-if=\"userDetail.gender_txt\"> - Giới tính: {{ userDetail.gender_txt }}</p>\n          <p v-if=\"userDetail.date_of_birth\"> - Ngày sinh: {{ userDetail.date_of_birth }}</p>\n          <p v-if=\"userDetail.status_txt\"> - Trạng thái: {{ userDetail.status_txt }}</p>\n        </v-flex>\n      </v-layout>\n      <v-flex xs12 v-if=\"userDetail.departments\">\n        <h3>Vị trí , chức vụ của nhân viên</h3>\n        <v-data-table\n        :headers=\"headersPosition\"\n        :items=\"userDetail.departments.data\"\n        hide-actions\n        class=\"elevation-1 mt-2\"\n        >\n        <template slot=\"items\" slot-scope=\"props\">\n          <td>{{ props.item.branch_name }}</td>\n          <td>{{ props.item.name }}</td>\n          <td>{{ props.item.position_name }}</td>\n        </template>\n      </v-data-table>\n    </v-flex>\n    <v-flex class=\"mt-4\" xs12 v-if=\"userDetail.contracts\">\n      <h3>Hợp đồng nhân viên\n        <v-btn v-if=\"canAccess('user.create')\"\n        class=\"mr-5\" icon color=\"primary\"\n        @click=\"addContract\">\n        <v-icon>add</v-icon\n          > </v-btn>\n        </h3>\n        <v-data-table\n        id=\"tableContract\"\n        :headers=\"headersContract\"\n        :items=\"userDetail.contracts.data\"\n        hide-actions\n        class=\"elevation-1 mt-2\"\n        >\n        <template slot=\"items\" slot-scope=\"props\">\n          <td colspan=\"2\">{{ props.item.title }}</td>\n          <td>{{ props.item.type_txt }}</td>\n          <td>{{ props.item.date_sign }}</td>\n          <td>{{ props.item.date_effective }}</td>\n          <td>{{ props.item.date_expiration }}</td>\n          <td>{{ props.item.status_txt }}</td>\n          <td colspan=\"2\" style=\"padding:2px;\">\n            <v-tooltip bottom class=\"ml-3\">\n              <v-btn style=\"margin:0px;\" slot='activator' v-if=\"canAccess('user.update')\" icon @click=\"editContract(props.item,props.item.id)\">\n                <v-icon size=\"19px\">edit</v-icon>\n              </v-btn>\n              <span>Sửa</span>\n            </v-tooltip>\n            <v-tooltip bottom>\n              <v-btn style=\"margin: 0px;\" slot=\"activator\" v-if=\"canAccess('user.delete')\" icon @click=\"removeConfirm(props.item.id)\">\n                <v-icon size=\"19px\">delete</v-icon>\n              </v-btn>\n              <span>Xóa</span>\n            </v-tooltip>\n          </td>\n        </template>\n      </v-data-table> </v-flex>\n    </v-container>\n    <v-dialog v-model=\"dialogEditContract\" max-width=\"500px\">\n      <v-card>\n        <v-card-title>\n          <span class=\"headline\">{{ formTitle }}</span>\n        </v-card-title>\n        <!-- form edit -->\n        <v-card-text id=\"formSub\">\n          <v-container grid-list-md class=\"white scroll-y border-e0-top\">\n            <v-layout row wrap>\n              <v-flex xs6 class=\"pr-2\">\n                <!-- title contract -->\n                <v-text-field\n                v-validate=\"'required'\"\n                placeholder=\"Nhập tiêu đề hợp đồng\"\n                :error-messages=\"errors.has('title') ? errors.collect('title') : []\"\n                :data-vv-as=\"$t('label.title')\"\n                name=\"title\"\n                :label=\"$t('label.title') + ' * '\"\n                v-model=\"contracts.title\"> </v-text-field>\n                <!-- type contract -->\n                <v-select\n                v-validate=\"'required'\"\n                :error-messages=\"errors.has('type') ? errors.collect('type') : []\"\n                :data-vv-as=\"$t('label.type')\"\n                name=\"type\"\n                :label=\"$t('label.type')\"\n                v-model=\"contracts.type\"\n                :items=\"typeContract\"\n                item-value=\"value\"\n                item-text=\"name\"> </v-select>\n                <!-- status contract-->\n                <v-select\n                v-validate=\"'required'\"\n                :error-messages=\"errors.has('status') ? errors.collect('status') : []\"\n                :data-vv-as=\"$t('label.status')\"\n                name=\"status\"\n                :label=\"$t('label.status')\"\n                v-model=\"contracts.status\"\n                :items=\"statusContract\"\n                item-value=\"value\"\n                item-text=\"name\"> </v-select>\n              </v-flex>\n              <v-flex xs6 class=\"pl-2\">\n                <!-- date_sign -->\n                <template>\n                  <v-menu\n                  v-validate=\"'required'\"\n                  ref=\"dateSign\"\n                  :close-on-content-click=\"false\"\n                  v-model=\"dateSign\"\n                  :nudge-right=\"40\"\n                  lazy transition=\"scale-transition\"\n                  offset-y\n                  full-width\n                  min-width=\"290px\">\n                  <v-text-field\n                  placeholder=\"Nhập ngày ký\"\n                  slot=\"activator\"\n                  v-model=\"contracts.date_sign\"\n                  label=\"Ngày ký\"\n                  readonly > </v-text-field>\n                  <v-date-picker\n                  ref=\"picker\"\n                  v-model=\"contracts.date_sign\"\n                  :max=\"new Date().toISOString().substr(0, 10)\"\n                  min=\"1950-01-01\"\n                  @change=\"save\"> </v-date-picker> </v-menu>\n                </template>\n                <!-- date_effective -->\n                <template>\n                  <v-menu\n                  v-validate=\"'required'\"\n                  ref=\"dateEffective\"\n                  :close-on-content-click=\"false\"\n                  v-model=\"dateEffective\"\n                  :nudge-right=\"40\"\n                  lazy transition=\"scale-transition\"\n                  offset-y\n                  full-width\n                  min-width=\"290px\">\n                  <v-text-field\n                  placeholder=\"Ngày có hiệu lực\"\n                  slot=\"activator\"\n                  v-model=\"contracts.date_effective\"\n                  label=\"Ngày có hiệu lực\"\n                  readonly > </v-text-field>\n                  <v-date-picker\n                  ref=\"picker\"\n                  v-model=\"contracts.date_effective\"\n                  :max=\"new Date().toISOString().substr(0, 10)\"\n                  min=\"1950-01-01\"\n                  @change=\"save\"> </v-date-picker> </v-menu>\n                </template>\n                <!-- date_expiration -->\n                <template>\n                  <v-menu\n                  v-validate=\"'required'\"\n                  ref=\"dateExpiration\"\n                  :close-on-content-click=\"false\"\n                  v-model=\"dateExpiration\"\n                  :nudge-right=\"40\"\n                  lazy transition=\"scale-transition\"\n                  offset-y\n                  full-width\n                  min-width=\"290px\">\n                  <v-text-field\n                  placeholder=\"Ngày hết hạn\"\n                  slot=\"activator\"\n                  v-model=\"contracts.date_expiration\"\n                  label=\"Ngày có hết hạn\"\n                  readonly > </v-text-field>\n                  <v-date-picker\n                  ref=\"picker\"\n                  v-model=\"contracts.date_expiration\"\n                  :max=\"new Date().toISOString().substr(0, 10)\"\n                  min=\"1950-01-01\"\n                  @change=\"save\"> </v-date-picker> </v-menu>\n                </template>\n              </v-flex>\n\n            </v-layout>\n          </v-container>\n        </v-card-text>\n        <!-- end form edit -->\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"blue darken-1\" flat @click.native=\"closeContract\">Hủy bỏ</v-btn>\n          <v-btn color=\"blue darken-1\" flat @click.native=\"submitForm\"><span v-if=\"editedIndex!==-1\">Lưu lại</span><span v-else>Thêm mới</span></v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </v-flex>\n  <dialog-confirm v-model=\"dialogDelete\" @input=\"remove\" />\n</v-layout>\n</template>\n\n<script>\nimport Listting from './Listting'\nimport { mapActions, mapGetters } from 'vuex'\nimport DialogConfirm from '@/components/DialogConfirm'\nexport default{\n  name: 'UserDetail',\n  components: {\n    Listting,\n    DialogConfirm\n  },\n  data () {\n    return {\n      contracts:\n      {\n        user_id: '',\n        status: 0,\n        type: 0,\n        date_sign: null,\n        date_effective: null,\n        date_expiration: null\n      },\n      typeContract: [\n        { name: 'Học việc', value: 0 },\n        { name: 'Cộng tác viên', value: 1 },\n        { name: 'Thử việc', value: 2 },\n        { name: 'Có thời hạn', value: 3 },\n        { name: 'Không thời hạn', value: 4 },\n        { name: 'Khác', value: 5 }\n      ],\n      statusContract: [\n        { name: 'Tiêu chuẩn', value: 0 },\n        { name: 'Chấm dứt', value: 1 },\n        { name: 'Gia hạn', value: 2 }\n      ],\n      // tiêu đề của bảng chi nhánh phòng ban , chức vụ\n      headersPosition: [\n        { text: 'Chi nhánh', value: 'branch', sortable: false },\n        { text: 'Phòng ban', value: 'department', sortable: false },\n        { text: 'Chức vụ', value: 'position', sortable: false }\n      ],\n      // tiêu đề của bảng hợp đồng\n      headersContract: [\n        { text: 'Tên hợp đồng', value: 'title', sortable: false },\n        { text: '', sortable: false },\n        { text: 'Loại hợp đồng', value: 'type', sortable: false },\n        { text: 'Ngày đăng kí', value: 'date_sign', sortable: false },\n        { text: 'Ngày bắt đầu', value: 'date_effective', sortable: false },\n        { text: 'Ngày kêt thúc', value: 'date_expiration', sortable: false },\n        { text: 'Trạng thái', value: 'status', sortable: false },\n        { text: 'Hành động', value: 'action', sortable: false }\n      ],\n      dataViewHeight: 0,\n      dialogEditContract: false,\n      dialogDelete: false,\n      dateSign: false,\n      dateEffective: false,\n      dateExpiration: false,\n      editedIndex: -1,\n      defaultItem: {\n        status: true\n      }\n    }\n  },\n  computed: {\n    // title of form Contract modal\n    formTitle () {\n      return this.editedIndex === -1 ? 'Thêm thông tin' : 'Sửa thông tin'\n    },\n    ...mapGetters('User', ['userDetail'])\n  },\n  watch: {\n    dateSign (val) {\n      val && this.$nextTick(() => (this.$refs.picker.activePicker = 'YEAR'))\n    },\n    dateEffective (val) {\n      val && this.$nextTick(() => (this.$refs.picker.activePicker = 'YEAR'))\n    },\n    dateExpiration (val) {\n      val && this.$nextTick(() => (this.$refs.picker.activePicker = 'YEAR'))\n    },\n    dataUser (val) {\n      this.user = val\n    }\n  },\n  methods: {\n    ...mapActions(['setMiniDrawer']),\n    ...mapActions('Contracts', ['createContract', 'updateContract', 'deleteContract']),\n    ...mapActions('User', ['getUser', 'deleteUser']),\n    ...mapActions('Dataview', ['removeDataviewEntry']),\n    ...mapActions(['showNotify']),\n    removeConfirm () {\n      this.dialogDelete = true\n    },\n    remove (confirm) {\n      if (confirm) {\n        this.deleteUser({\n          id: this.$route.params.id,\n          cb: (response) => {\n            this.removeDataviewEntry({\n              name: 'user',\n              data: this.userDetail,\n              key: 'id'\n            })\n            this.$store.dispatch('showNotify', {\n              text: this.$t('alert.success'),\n              color: 'success'\n            })\n            this.dialogDelete = false\n            this.$router.push({ name: 'user' })\n          },\n          error: (error) => {\n            if (error.status === 404) {\n              this.$store.dispatch('showNotify', {\n                text: this.$t('alert.not-found'),\n                color: 'warning'\n              })\n            }\n          }\n        })\n      }\n    },\n    save (date) {\n      this.$refs.dateSign.save(date)\n      this.$refs.dateEffective.save(date)\n      this.$refs.dateExpiration.save(date)\n    },\n    // contract\n    editContract (item, id) {\n      this.idContract = id\n      this.editedIndex = 1\n      this.contracts = Object.assign({}, item)\n      this.dialogEditContract = true\n    },\n    addContract () {\n      this.contracts = this.contracts\n      this.dialogEditContract = true\n    },\n    closeContract () {\n      this.dialogEditContract = false\n      setTimeout(() => {\n        if (this.editedIndex === -1) {\n          this.editedIndex = -1\n        } else {\n          this.contracts = Object.assign({}, this.defaultItem)\n          this.editedIndex = -1\n        }\n      }, 300)\n    },\n    submitForm () {\n      if (this.editedIndex === -1) {\n        this.createContract({\n          contract: this.contracts,\n          cb: (response) => {\n            this.dialog = false\n            setTimeout(() => {\n              this.contracts = Object.assign({}, this.defaultItem)\n              this.editedIndex = -1\n            }, 300)\n            this.showNotify({\n              color: 'success',\n              text: 'Thành công'\n            })\n            this.getUser({ userId: this.$route.params.id, params: { include: 'roles,departments,contracts' } })\n          }\n        })\n      } else {\n        this.updateContract({\n          id: this.idContract,\n          contract: this.contracts,\n          cb: (response) => {\n            this.showNotify({\n              color: 'success',\n              text: 'Thành công'\n            })\n            setTimeout(() => {\n              this.contracts = Object.assign({}, this.defaultItem)\n              this.editedIndex = -1\n            }, 300)\n            this.getUser({ userId: this.$route.params.id, params: { include: 'roles,departments,contracts' } })\n            this.dialogEditContract = false\n          }\n        })\n      }\n    },\n    // thời gian đăng kí , có hiệu lực hợp đồng\n    dateConstract () {\n      let today = new Date()\n      let dd = today.getDate()\n      let mm = today.getMonth() + 1\n      let yyyy = today.getFullYear()\n\n      if (dd < 10) {\n        dd = '0' + dd\n      }\n\n      if (mm < 10) {\n        mm = '0' + mm\n      }\n      today = yyyy + '-' + mm + '-' + dd\n      this.contracts.date_sign = today\n      this.contracts.date_effective = today\n    },\n    // thời gian kết thúc hợp đồng\n    dateExpirationConstract () {\n      let today = new Date()\n      let dd = today.getDate()\n      let mm = today.getMonth() + 3\n      let yyyy = today.getFullYear()\n\n      if (dd < 10) {\n        dd = '0' + dd\n      }\n\n      if (mm < 10) {\n        mm = '0' + mm\n      }\n      today = yyyy + '-' + mm + '-' + dd\n      this.contracts.date_expiration = today\n    }\n  },\n  created () {\n    this.dateExpirationConstract()\n    this.dateConstract()\n    this.setMiniDrawer(true)\n    if (!this.userDetail.id) {\n      this.getUser({ userId: this.$route.params.id, params: { include: 'roles,departments,contracts' } })\n    }\n  },\n  mounted () {\n    this.dataViewHeight = this.$refs.laylout.clientHeight - 50\n  }\n}\n</script>\n"],"sourceRoot":"src/views/user"}]}