{"remainingRequest":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/babel-loader/lib/index.js!/home/nguyenxuancuong/Sites/hrm_fe/node_modules/eslint-loader/index.js??ref--13-0!/home/nguyenxuancuong/Sites/hrm_fe/src/store/modules/api.js","dependencies":[{"path":"/home/nguyenxuancuong/Sites/hrm_fe/src/store/modules/api.js","mtime":1538377839382},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/cache-loader/dist/cjs.js","mtime":1534394480737},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/babel-loader/lib/index.js","mtime":1534394476611},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/eslint-loader/index.js","mtime":1534394478618}],"contextDependencies":[],"result":["import _defineProperty from \"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/@babel/runtime/helpers/builtin/es6/defineProperty\";\nimport _regeneratorRuntime from \"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/@babel/runtime/helpers/builtin/es6/asyncToGenerator\";\n\nvar _mutations;\n\nimport axios from '@/plugins/axios.js';\nimport router from '@/router';\nimport { FETCHING_RESOURCES, FETCHING_RESOURCES_DONE, FETCHING_RESOURCES_FAIL, SET_INITIAL_STATE } from '../mutation-types';\nimport { forIn } from 'lodash';\n\nvar initState = function initState() {\n  return {\n    fetchApi: false,\n    apiErrors: null\n  };\n};\n/**\n * state\n */\n\n\nvar state = {\n  fetchApi: initState().fetchApi,\n  apiErrors: initState().apiErrors\n  /**\n   * actions\n   */\n\n};\nvar actions = {\n  fetchApi: function () {\n    var _fetchApi = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(_ref) {\n      var commit,\n          dispatch,\n          state,\n          payload,\n          success,\n          error,\n          showWarnings,\n          response,\n          err,\n          msg,\n          _args = arguments;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              commit = _ref.commit, dispatch = _ref.dispatch, state = _ref.state;\n              payload = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n              success = payload.success, error = payload.error, showWarnings = payload.showWarnings;\n              showWarnings = showWarnings === undefined ? true : showWarnings;\n              _context.prev = 4;\n              commit(FETCHING_RESOURCES, true);\n              _context.next = 8;\n              return axios.request(payload);\n\n            case 8:\n              response = _context.sent;\n              commit(FETCHING_RESOURCES_DONE);\n              _context.t0 = success;\n\n              if (!_context.t0) {\n                _context.next = 14;\n                break;\n              }\n\n              _context.next = 14;\n              return success(response.data);\n\n            case 14:\n              _context.next = 44;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t1 = _context[\"catch\"](4);\n              err = null;\n\n              if (!_context.t1.response) {\n                _context.next = 41;\n                break;\n              }\n\n              if (!showWarnings) {\n                _context.next = 38;\n                break;\n              }\n\n              _context.t2 = _context.t1.response.status;\n              _context.next = _context.t2 === 422 ? 24 : _context.t2 === 403 ? 28 : _context.t2 === 401 ? 31 : _context.t2 === 500 ? 35 : 38;\n              break;\n\n            case 24:\n              msg = [];\n              forIn(_context.t1.response.data.data.errors, function (err, idx) {\n                if (typeof err === 'string') {\n                  msg.push('&bullet; ' + err);\n                } else {\n                  msg.push('&bullet; ' + err[0]);\n                }\n              });\n              dispatch('showNotify', {\n                text: msg.join('<br />'),\n                color: 'warning'\n              });\n              return _context.abrupt(\"break\", 38);\n\n            case 28:\n              dispatch('showNotify', {\n                text: 'Bạn không có quyền thực hiện tác vụ này',\n                color: 'warning'\n              });\n              router.push({\n                name: 'forbidden'\n              });\n              return _context.abrupt(\"break\", 38);\n\n            case 31:\n              dispatch('showNotify', {\n                text: 'Phiên đăng nhập hết hạn vui lòng đăng nhập',\n                color: 'warning'\n              });\n              dispatch('clearLogged');\n              router.push({\n                name: 'login'\n              });\n              return _context.abrupt(\"break\", 38);\n\n            case 35:\n              dispatch('showNotify', {\n                text: 'Máy chủ sảy ra sự cố vui lòng thử lại sau',\n                color: 'error'\n              });\n              router.push({\n                name: 'opps'\n              });\n              return _context.abrupt(\"break\", 38);\n\n            case 38:\n              err = _context.t1.response;\n              _context.next = 42;\n              break;\n\n            case 41:\n              if (_context.t1.request) {\n                err = _context.t1.request;\n              } else {\n                err = _context.t1.message;\n              }\n\n            case 42:\n              commit(FETCHING_RESOURCES_FAIL, err);\n              error && error(err);\n\n            case 44:\n              _context.prev = 44;\n              commit(FETCHING_RESOURCES, false);\n              return _context.finish(44);\n\n            case 47:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[4, 16, 44, 47]]);\n    }));\n\n    return function fetchApi(_x) {\n      return _fetchApi.apply(this, arguments);\n    };\n  }()\n};\n/**\n * mutations\n */\n\nvar mutations = (_mutations = {}, _defineProperty(_mutations, FETCHING_RESOURCES_FAIL, function (state, err) {\n  state.apiErrors = err.response;\n}), _defineProperty(_mutations, FETCHING_RESOURCES_DONE, function (state) {\n  state.apiErrors = null;\n}), _defineProperty(_mutations, FETCHING_RESOURCES, function (state, isFechApi) {\n  state.fetchApi = isFechApi;\n}), _defineProperty(_mutations, SET_INITIAL_STATE, function (state) {\n  state.fetchApi = initState().fetchApi;\n  state.apiErrors = initState().apiErrors;\n}), _mutations);\n/**\n * getters\n */\n\nvar getters = {\n  allApiErrors: function allApiErrors(state) {\n    return state.apiErrors;\n  },\n  isFetchingApi: function isFetchingApi(state) {\n    return state.fetchApi;\n  }\n};\nexport default {\n  state: state,\n  actions: actions,\n  mutations: mutations,\n  getters: getters\n};",{"version":3,"sources":["src/store/modules/api.js"],"names":["axios","router","FETCHING_RESOURCES","FETCHING_RESOURCES_DONE","FETCHING_RESOURCES_FAIL","SET_INITIAL_STATE","forIn","initState","fetchApi","apiErrors","state","actions","commit","dispatch","payload","success","error","showWarnings","undefined","request","response","data","err","status","msg","errors","idx","push","text","join","color","name","message","mutations","isFechApi","getters","allApiErrors","isFetchingApi"],"mappings":"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","sourceRoot":"/home/nguyenxuancuong/Sites/hrm_fe","sourcesContent":["import axios from '@/plugins/axios.js'\nimport router from '@/router'\nimport {\n  FETCHING_RESOURCES,\n  FETCHING_RESOURCES_DONE,\n  FETCHING_RESOURCES_FAIL,\n  SET_INITIAL_STATE\n} from '../mutation-types'\nimport { forIn } from 'lodash'\n\nconst initState = () => {\n  return {\n    fetchApi: false,\n    apiErrors: null\n  }\n}\n\n/**\n * state\n */\nconst state = {\n  fetchApi: initState().fetchApi,\n  apiErrors: initState().apiErrors\n}\n\n/**\n * actions\n */\nconst actions = {\n  async fetchApi ({ commit, dispatch, state }, payload = {}) {\n    let { success, error, showWarnings } = payload\n    showWarnings = showWarnings === undefined ? true : showWarnings\n\n    try {\n      commit(FETCHING_RESOURCES, true)\n      let response = await axios.request(payload)\n      commit(FETCHING_RESOURCES_DONE)\n      success && await success(response.data)\n    } catch (e) {\n      let err = null\n      if (e.response) {\n        if (showWarnings) {\n          switch (e.response.status) {\n            case 422:\n              let msg = []\n              forIn(e.response.data.data.errors, (err, idx) => {\n                if (typeof err === 'string') {\n                  msg.push('&bullet; ' + err)\n                } else {\n                  msg.push('&bullet; ' + err[0])\n                }\n              })\n              dispatch('showNotify', { text: msg.join('<br />'), color: 'warning' })\n              break\n            case 403:\n              dispatch('showNotify', { text: 'Bạn không có quyền thực hiện tác vụ này', color: 'warning' })\n              router.push({ name: 'forbidden' })\n              break\n            case 401:\n              dispatch('showNotify', { text: 'Phiên đăng nhập hết hạn vui lòng đăng nhập', color: 'warning' })\n              dispatch('clearLogged')\n              router.push({ name: 'login' })\n              break\n            case 500:\n              dispatch('showNotify', { text: 'Máy chủ sảy ra sự cố vui lòng thử lại sau', color: 'error' })\n              router.push({ name: 'opps' })\n              break\n          }\n        }\n        err = e.response\n      } else if (e.request) {\n        err = e.request\n      } else {\n        err = e.message\n      }\n      commit(FETCHING_RESOURCES_FAIL, err)\n      error && error(err)\n    } finally {\n      commit(FETCHING_RESOURCES, false)\n    }\n  }\n}\n\n/**\n * mutations\n */\nconst mutations = {\n  [FETCHING_RESOURCES_FAIL]: (state, err) => {\n    state.apiErrors = err.response\n  },\n  [FETCHING_RESOURCES_DONE]: (state) => {\n    state.apiErrors = null\n  },\n  [FETCHING_RESOURCES]: (state, isFechApi) => {\n    state.fetchApi = isFechApi\n  },\n  [SET_INITIAL_STATE]: (state) => {\n    state.fetchApi = initState().fetchApi\n    state.apiErrors = initState().apiErrors\n  }\n}\n\n/**\n * getters\n */\nconst getters = {\n  allApiErrors: (state) => state.apiErrors,\n  isFetchingApi: (state) => state.fetchApi\n}\n\nexport default {\n  state,\n  actions,\n  mutations,\n  getters\n}\n"]}]}