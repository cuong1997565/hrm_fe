{"remainingRequest":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/nguyenxuancuong/Sites/hrm_fe/src/views/contracts/Listting.vue?vue&type=style&index=0&id=48faf818&scoped=true&lang=css&","dependencies":[{"path":"/home/nguyenxuancuong/Sites/hrm_fe/src/views/contracts/Listting.vue","mtime":1538921765927},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/postcss-loader/lib/index.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/cache-loader/dist/cjs.js","mtime":1538403001796},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n .v-input.v-text-field{\n  margin-top: 4px;\n}\n",{"version":3,"sources":["Listting.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+aA;AACA;AACA","file":"Listting.vue","sourceRoot":"src/views/contracts","sourcesContent":["<template>\n          <v-layout ref=\"laylout\" column fill-height>\n            <div ref=\"header\">\n              <v-toolbar height=\"60px\" color=\"white\" flat>\n                <v-layout row wrap>\n                 <v-flex md1 xs3 :class=\"isMini\">\n                  <!--  <v-tooltip bottom> -->\n                  <v-tooltip bottom>\n                    <v-btn slot=\"activator\" v-if=\"canAccess('contract.create')\"\n                    @click=\"$router.push({name: 'contract-create'})\"\n                    class=\"mr-3 mt-3\" icon color=\"primary\"\n                    >\n                    <v-icon>add</v-icon\n                      ></v-btn>\n                      <span>Thêm mới</span>\n                    </v-tooltip>\n                    <!--  <span>Thêm mới</span> -->\n                    <!-- </v-tooltip> -->\n                  </v-flex>\n                  <v-flex xs6 class=\" pr-2\" :class=\"isMini && 'full-flex-basic'\">\n                    <v-text-field\n                    hide-details\n                    single-line\n                    placeholder=\"Nhập tiêu đề hợp đồng\"\n                    v-model=\"params.q\"\n                    clearable\n                    @click:clear=\"resetSreach\"\n                    @keyup=\"changeSearch\"\n                    ></v-text-field>\n                  </v-flex>\n                  <v-flex xs5 :class=\"isMini && 'd-none'\">\n                    <v-autocomplete\n                    :items=\"users\"\n                    item-value=\"id\"\n                    @change=\"filter\"\n                    v-model=\"params.userId\"\n                    placeholder=\"Chọn tên nhân viên\"\n                    item-text=\"name\"\n                    clearable\n                    v-if=\"Array.isArray(users)\"\n                    >\n                    </v-autocomplete\n                    > </v-flex>\n                  </v-layout>\n                </v-toolbar>\n                <v-toolbar height=\"50px\" color=\"white\" flat>\n                  <v-layout row wrap>\n                   <v-flex xs3 :class=\"isMini && 'd-none'\">\n                    <v-autocomplete\n                    :items=\"types\"\n                    item-value=\"id\"\n                    @change=\"filter\"\n                    v-model=\"params.type\"\n                    placeholder=\"Chọn loại\"\n                    item-text=\"name\"\n                    clearable\n                    >\n                  </v-autocomplete> </v-flex>\n                  <v-flex xs3 class=\"pl-2 pr-2\" :class=\"isMini && 'd-none'\">\n                    <v-autocomplete\n                    :items=\"status\"\n                    item-value=\"id\"\n                    @change=\"filter\"\n                    v-model=\"params.status\"\n                    placeholder=\"Chọn trạng thái\"\n                    item-text=\"name\"\n                    clearable >\n                  </v-autocomplete> </v-flex>\n                  <v-flex xs4 class=\"pl-2\">\n                    <v-text-field\n                    hide-details\n                    single-line\n                    v-model=\"params.date\"\n                    placeholder=\"Tìm kiếm từ ngày ký  đến ngày hết hạn\"\n                    clearable\n                    @click:clear=\"resetSreach\"\n                    @click=\"openDialog\"></v-text-field>\n                    <v-dialog style=\"margin-left:10px\" v-model=\"dialog\" max-width=\"900px\" max-height=\"1200px\">\n                     <v-card>\n                      <v-daterange id='dateRange' :options=\"dateRangeOptions\" @input=\"onDateRangeChange\"></v-daterange>\n                      <v-card-actions>\n                        <v-spacer></v-spacer>\n                        <v-btn flat\n                        @click.native=\"submitDate\"\n                        color=\"success darken-1\"\n                        >\n                        <span>Đồng ý</span>\n                      </v-btn>\n                      <v-btn color=\"error darken-1\" flat  @click.native=\"close\" class=\"ml-2\">Hủy bỏ</v-btn>\n                      <v-spacer></v-spacer>\n                    </v-card-actions>\n                  </v-card>\n                </v-dialog>\n              </v-flex>\n              <v-flex xs2 class=\"pl-2\" :class=\"isMini && 'd-none'\">\n                <v-autocomplete\n                :items=\"month\"\n                item-value=\"id\"\n                @change=\"filter\"\n                v-model=\"params.monthExpiration\"\n                placeholder=\"Chọn tháng\"\n                item-text=\"name\"\n                clearable\n                ></v-autocomplete>\n              </v-flex>\n            </v-layout>\n            <v-layout slot=\"extension\" v-if=\"!isMini\" class=\"pt-2 pb-2\">\n              <v-flex sm1 class=\"text-bold text-uppercase\">\n                #\n              </v-flex>\n              <v-flex sm3 class=\"text-bold text-uppercase\">\n                tiêu đề\n              </v-flex>\n              <v-flex sm2 class=\"text-bold text-uppercase\">\n                loại\n              </v-flex>\n              <v-flex  sm2 class=\"text-uppercase text-bold\">\n                tên nhân viên\n              </v-flex>\n              <v-flex sm3 class=\"text-uppercase text-bold\">\n                <v-flex sm12>Ngaỳ</v-flex>\n              </v-flex>\n                <!--   <v-flex sm2 class=\"text-bold text-uppercase\">\n                    trạng thái\n                  </v-flex> -->\n                  <v-flex sm1 class=\"text-bold text-uppercase\">\n                    Hành động\n                  </v-flex>\n                </v-layout>\n              </v-toolbar>\n            </div>\n            <v-flex xs12  class=\"border-e0-top\">\n              <data-view\n              :name=\"dataViewName\"\n              api-url=\"contracts\"\n              v-if=\"dataViewHeight\"\n              :viewHeight=\"dataViewHeight\"\n              :params=\"params\"\n              :ref=\"dataViewName\">\n              <template slot-scope=\"{items}\">\n                <v-list three-line>\n                  <template v-for=\"(item, index) in items.data\">\n                   <v-list-tile\n                   :key=\"'item' + item.id\"\n                   avatar\n                   @click=\"contractDetail(item)\"\n                   :inactive=\"item.id === $route.params.id\"\n                   :class=\"item.id === $route.params.id && 'grey lighten-2'\"\n                   >\n                   <v-layout class=\"pa-2\">\n                    <v-flex sm1 :class=\"isMini && 'd-none'\">\n                      {{index + 1}}\n                    </v-flex>\n                    <v-flex  class=\"pr-2 \" xs3 :class=\"isMini && 'full-flex-basic full-max-width'\">\n                      {{ item.title }}\n                    </v-flex>\n                    <v-flex  sm2  :class=\"isMini && 'd-none'\">\n                     <v-tooltip bottom sm12>\n                       <v-flex xs12  slot=\"activator\">\n                        {{ item.type_txt }}\n                      </v-flex>\n                      <span> Loại hợp đồng</span>\n                    </v-tooltip>\n                    <v-tooltip bottom sm12>\n                      <v-flex xs12 slot=\"activator\">\n                        {{ item.status_txt }}\n                      </v-flex>\n                      <span>Trạng thái hợp đồng</span>\n                    </v-tooltip>\n\n                  </v-flex>\n                  <v-flex class=\"pr-5 pl-2\" xs2 :class=\"isMini && 'd-none'\">\n                    {{item.user_name}}\n                  </v-flex>\n                  <v-flex xs3  class=\"pl-2\" :class=\"isMini  && 'd-none'\">\n                    <v-tooltip  bottom sm12>\n                      <v-flex xs12 slot=\"activator\">\n                        <span>Đăng ký :</span>\n                        {{item.date_sign}}\n                      </v-flex>\n                      <span>Ngày đăng ký</span>\n                    </v-tooltip>\n                    <v-tooltip bottom sm12>\n                     <v-flex xs12 slot=\"activator\">\n                       <span>Kết thúc :</span>\n                       {{ item.date_expiration }}\n                     </v-flex>\n                     <span>Ngày  kết thúc</span>\n                   </v-tooltip>\n                 </v-flex>\n                 <v-flex xs1 class=\"pl-1\" :class=\"isMini && 'd-none'\">\n                   <v-tooltip bottom>\n                    <v-btn slot=\"activator\" class=\"ma-0\" v-if=\"canAccess('contracts.update')\" icon @click.stop=\"editContract(item.id)\">\n                      <v-icon class='theme--light teal--text'>edit</v-icon>\n                    </v-btn>\n                    <span>Sửa</span>\n                  </v-tooltip>\n                  <v-tooltip bottom>\n                    <v-btn slot=\"activator\" class=\"ma-0\" v-if=\"canAccess('contracts.delete')\" icon @click.stop=\"removeConfirm(item.id)\">\n                      <v-icon class=\"theme--light pink--text\">delete</v-icon>\n                    </v-btn>\n                    <span>Xóa</span>\n                  </v-tooltip>\n                </v-flex>\n              </v-layout>\n            </v-list-tile>\n            <v-divider\n            :key=\"'div' + index + item.id\"\n            v-if=\"index + 1 < items.data.length\"\n            ></v-divider>\n          </template>\n        </v-list>\n      </template>\n    </data-view>\n  </v-flex>\n  <dialog-confirm v-model=\"dialogDelete\" @input=\"remove\" />\n</v-layout>\n</template>\n<script type=\"text/javascript\">\nimport 'vuetify-daterange-picker/dist/vuetify-daterange-picker.css'\nimport DialogConfirm from '@/components/DialogConfirm'\nimport { debounce } from 'lodash'\nimport { format, subDays } from 'date-fns'\nimport DataView from '@/components/DataView/DataView'\nimport { mapActions, mapGetters } from 'vuex'\nexport default{\n  name: 'ContractListting',\n  props: {\n    isMini: {\n      type: Boolean,\n      default: false\n    }\n  },\n  components: {\n    DataView,\n    DialogConfirm\n  },\n  data: () => ({\n    dialogDelete: false,\n    dataViewHeight: 0,\n    dialog: false,\n    range: [],\n    dateRangeOptions: {\n      startDate: format(subDays(new Date(), 7), 'YYYY-MM-DD'),\n      endDate: format(new Date(), 'YYYY-MM-DD'),\n      format: 'MM/DD/YYYY',\n      presets: [\n        {\n          label: 'Hôm nay',\n          range: [\n            format(new Date(), 'YYYY-MM-DD'),\n            format(new Date(), 'YYYY-MM-DD')\n          ]\n        },\n        {\n          label: 'Hôm qua',\n          range: [\n            format(subDays(new Date(), 1), 'YYYY-MM-DD'),\n            format(subDays(new Date(), 1), 'YYYY-MM-DD')\n          ]\n        },\n        {\n          label: '30 ngày trước',\n          range: [\n            format(subDays(new Date(), 30), 'YYYY-MM-DD'),\n            format(subDays(new Date(), 1), 'YYYY-MM-DD')\n          ]\n        }\n      ]\n    },\n    users: [],\n    dataViewName: 'contract',\n    idContract: null,\n    types: [\n      { 'id': 0, 'name': 'Học việc' },\n      { 'id': 1, 'name': 'Cộng tác viên' },\n      { 'id': 2, 'name': 'Thử việc' },\n      { 'id': 3, 'name': 'Có thời hạn' },\n      { 'id': 4, 'name': 'Không thời hạn' },\n      { 'id': 5, 'name': 'Khác' }\n    ],\n    status: [\n      { 'id': 0, 'name': 'Tiêu chuẩn' },\n      { 'id': 1, 'name': 'Chấm dứt' },\n      { 'id': 2, 'name': 'Gia hạn' }\n    ],\n    month: [\n      { 'id': 1, 'name': ' Tháng một ' },\n      { 'id': 2, 'name': ' Tháng hai ' },\n      { 'id': 3, 'name': ' Tháng ba ' },\n      { 'id': 4, 'name': ' Tháng bốn  ' },\n      { 'id': 5, 'name': ' Tháng năm ' },\n      { 'id': 6, 'name': ' Tháng sáu ' },\n      { 'id': 7, 'name': ' Tháng bảy ' },\n      { 'id': 8, 'name': ' Tháng tám ' },\n      { 'id': 9, 'name': ' Tháng chín  ' },\n      { 'id': 10, 'name': ' Tháng mười ' },\n      { 'id': 11, 'name': ' Tháng mười một  ' },\n      { 'id': 12, 'name': ' Tháng mười hai ' }\n    ],\n    params: {\n      q: '',\n      userId: '',\n      type: '',\n      status: '',\n      date: '',\n      dateSignStart: '',\n      dateSignEnd: '',\n      monthExpiration: ''\n    }\n  }),\n  computed: {\n    ...mapGetters(['isFetchingApi']),\n    ...mapGetters('User', ['userDetail'])\n    // ...mapGetters('Contracts', ['contractDetail'])\n  },\n  methods: {\n    ...mapActions(['fetchApi']),\n    ...mapActions('Dataview', ['removeDataviewEntry']),\n    ...mapActions('Contracts', ['deleteContract', 'getContract']),\n    ...mapActions('User', ['fetchUser']),\n    openDialog () {\n      this.dialog = true\n    },\n    close () {\n      this.dialog = false\n    },\n    onDateRangeChange (range) {\n      this.range = range\n      // console.log(\"data renge :\",range);\n    },\n    submitDate () {\n      if (this.range[0] === undefined || this.range[1] === undefined) {\n        this.dialog = true\n        this.$store.dispatch('showNotify', {\n          text: this.$t('alert.date'),\n          color: 'warning'\n        })\n      } else {\n        this.params.dateSignStart = this.range[0]\n        this.params.dateSignEnd = this.range[1]\n        this.params.date = 'Từ ngày ' + this.range[0]\n        this.params.date += ' đến ngày ' + this.range[1]\n        console.log('data filter :', this.range[0] + ' den ' + this.range[1])\n        this.dialog = false\n        this.changeSearch()\n      }\n    },\n    // deteail contract\n    contractDetail (contract) {\n      this.getContract({ contractId: contract.id })\n      // this.$router.push({ name: 'contract-detail', params: { id: contract.id } })\n    },\n    //\n    editContract (id) {\n      this.getContract({ contractId: id })\n      this.$router.push({ name: 'contract-edit', params: { id: id } })\n    },\n    /// screach\n    changeSearch: debounce(function () {\n      this.filter()\n    }, 500),\n    filter () {\n      this.$refs[this.dataViewName].$emit('reload')\n    },\n    /// / reset screach\n    resetSreach: debounce(function () {\n      this.filter()\n    }, 100),\n    removeConfirm (id) {\n      this.idContract = id\n      this.dialogDelete = true\n    },\n    remove (confirm) {\n      if (confirm) {\n        this.deleteContract({\n          id: this.idContract,\n          cb: (response) => {\n            this.removeDataviewEntry({\n              name: 'contract',\n              data: this.contractDetail,\n              key: 'id'\n            })\n            this.$store.dispatch('showNotify', {\n              text: this.$t('alert.success'),\n              color: 'success'\n            })\n            this.dialogDelete = false\n            this.$refs[this.dataViewName].$emit('reload')\n          },\n          error: (error) => {\n            if (error.status === 404) {\n              this.$store.dispatch('showNotify', {\n                text: this.$t('alert.not-found'),\n                color: 'warning'\n              })\n            }\n          }\n        })\n      }\n    }\n  },\n  mounted () {\n    this.fetchApi({\n      url: 'users',\n      method: 'GET',\n      params: {\n        limit: -1\n      },\n      success: (response) => {\n        this.users = response.data\n      }\n    })\n    this.dataViewHeight = this.$refs.laylout.clientHeight - 165\n    let query = { ...this.$route.query }\n    if (query.hasOwnProperty('reload')) {\n      this.$nextTick(() => {\n        this.$refs[this.dataViewName].$emit('reload')\n      })\n      delete query.reload\n      this.$router.replace({\n        query: query\n      })\n    }\n  },\n  created () {\n    this.fetchUser()\n  }\n}\n</script>\n<style scoped>\n  .v-input.v-text-field{\n   margin-top: 4px;\n }\n</style>\n"]}]}