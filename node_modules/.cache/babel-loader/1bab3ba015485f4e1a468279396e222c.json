{"remainingRequest":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/babel-loader/lib/index.js!/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/nguyenxuancuong/Sites/hrm_fe/src/views/user/Form_sub.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/nguyenxuancuong/Sites/hrm_fe/src/views/user/Form_sub.vue","mtime":1538475922749},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/cache-loader/dist/cjs.js","mtime":1538403001796},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/@babel/runtime/helpers/builtin/es6/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters, mapActions } from 'vuex';\nexport default {\n  name: 'UserFormSub',\n  data: function data() {\n    return {\n      departments: {},\n      departmentActive: false,\n      positionActive: false,\n      user: {\n        departments: []\n      }\n    };\n  },\n  props: {\n    index: {\n      type: Number,\n      default: 0\n    },\n    dataUser: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    }\n  },\n  computed: _objectSpread({}, mapGetters('Branch', ['branchAll']), mapGetters('Department', ['departmentByBranch']), mapGetters('Position', ['positionAll'])),\n  methods: _objectSpread({}, mapActions(['fetchApi']), mapActions('Position', ['fetchPosition']), mapActions('Branch', ['getBranchForUser']), mapActions('Department', ['getDepartmentForUser']), {\n    addDepartment: function addDepartment() {\n      this.user.departments.push({});\n    },\n    deleteDepartment: function deleteDepartment(index) {\n      this.user.departments.splice(index, 1);\n      this.emitDepartment();\n    },\n    changeBranch: function changeBranch(value) {\n      // nếu branch thay đổi thì select box của department không bị disable\n      this.departmentActive = true;\n    },\n    changeDepartment: function changeDepartment(value) {\n      this.positionActive = true;\n      this.emitDepartment();\n    },\n    changePosition: function changePosition(value) {\n      this.emitDepartment();\n    },\n    // thực hiện emit khi có sự thay đổi về dữ liệu\n    emitDepartment: function emitDepartment() {\n      this.$emit('positionAndDepartment', this.user.departments);\n    },\n    setInitData: function setInitData() {\n      var dataUser = _objectSpread({}, this.dataUser);\n\n      this.user = _objectSpread({}, this.user, dataUser); // nếu mảng dataUser.departments không có gía trị thì push thêm một mảng rỗng\n\n      if (this.dataUser.departments.data) {\n        this.departmentActive = true;\n        this.positionActive = true;\n        this.user.departments = this.dataUser.departments.data.length ? this.user.departments.data : [{}];\n      } else {\n        this.user.departments.push({});\n      }\n    }\n  }),\n  created: function created() {\n    var _this = this;\n\n    this.fetchApi({\n      url: 'departments',\n      method: 'GET',\n      params: {\n        limit: -1\n      },\n      success: function success(response) {\n        var items = response.data;\n        items.forEach(function (item) {\n          if (!_this.departments[item.branch_id]) {\n            _this.departments[item.branch_id] = [];\n          }\n\n          _this.departments[item.branch_id].push(item);\n        });\n      }\n    });\n    this.getBranchForUser();\n    this.fetchPosition();\n    !!this.dataUser && this.setInitData();\n  }\n};",{"version":3,"sources":["Form_sub.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <v-layout row wrap align-center style=\"margin-top: 20px;\">\n    <!-- branch,department,position -->\n    <v-flex row wrap sm12>\n      <h3>Chi nhánh, phòng ban, chức vụ\n        <v-tooltip right>\n          <v-btn slot=\"activator\" class=\"mr-3\"\n          icon color=\"primary\"\n          @click=\"addDepartment\">\n          <v-icon>add</v-icon> </v-btn>\n          <span>Thêm chức vụ</span>\n        </v-tooltip></h3>\n      </v-flex>\n      <v-layout row wrap :key=\"index\" v-for=\"(department, index) in user.departments\">\n        <v-flex md4>\n          <label>Chi nhánh</label>\n          <v-select\n          v-model=\"user.departments[index].branch_id\"\n          label=\"Chi nhánh\"\n          :items=\"branchAll\"\n          item-text=\"name\"\n          item-value=\"id\"\n          :error-messages=\"errors.has('branch_id') ? errors.collect('branch_id') : []\"\n          name=\"branch_id\"\n          placeholder=\"Thuộc chi nhánh\"\n          single-line\n          @change= \"changeBranch\"\n          ></v-select>\n        </v-flex>\n        <v-spacer></v-spacer>\n        <!-- department -->\n        <v-flex md4 id=\"position\">\n          <label>Phòng ban</label>\n          <v-select\n          v-model=\"user.departments[index].department_id\"\n          label=\"Phòng ban\"\n          :disabled=\"!departmentActive\"\n          :items=\"departments[user.departments[index].branch_id]\"\n          item-text=\"name\"\n          item-value=\"department_id\"\n          :error-messages=\"errors.has ('department_id') ? errors.collect('department_id') : []\"\n          name=\"department_id\"\n          placeholder=\"Thuộc phòng ban\"\n          single-line\n          @change=\"changeDepartment\"></v-select>\n        </v-flex>\n        <v-spacer></v-spacer><v-flex md3>\n          <!-- postion -->\n          <label>Chức vụ</label>\n          <v-select\n          v-model=\"user.departments[index].position_id\"\n          :items=\"positionAll\"\n          :disabled=\"!positionActive\"\n          item-text=\"name\"\n          item-value=\"id\"\n          :error-messages=\"errors.has('position_id') ? errors.collect('position_id') : []\"\n          name=\"position_id\"\n          placeholder=\"Vị trí\"\n          single-line\n          @change=\"changePosition\"></v-select></v-flex>\n          <v-tooltip bottom>\n            <v-btn slot=\"activator\" style=\"margin-top:35px;\"\n            icon color=\"error\"\n            @click=\"deleteDepartment(index)\">\n            <v-icon>delete</v-icon>\n          </v-btn>\n          <span>Xóa</span>\n        </v-tooltip>\n      </v-layout>\n    </v-layout>\n  </template>\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nexport default {\n  name: 'UserFormSub',\n  data () {\n    return {\n      departments: {},\n      departmentActive: false,\n      positionActive: false,\n      user: {\n        departments: []\n      }\n    }\n  },\n  props: {\n    index: {\n      type: Number,\n      default: 0\n    },\n    dataUser: {\n      type: Object,\n      default: () => {\n        return {}\n      }\n    }\n  },\n  computed: {\n    ...mapGetters('Branch', ['branchAll']),\n    ...mapGetters('Department', ['departmentByBranch']),\n    ...mapGetters('Position', ['positionAll'])\n  },\n  methods: {\n    ...mapActions(['fetchApi']),\n    ...mapActions('Position', ['fetchPosition']),\n    ...mapActions('Branch', ['getBranchForUser']),\n    ...mapActions('Department', ['getDepartmentForUser']),\n    addDepartment () {\n      this.user.departments.push({})\n    },\n    deleteDepartment (index) {\n      this.user.departments.splice(index, 1)\n      this.emitDepartment()\n    },\n    changeBranch (value) {\n      // nếu branch thay đổi thì select box của department không bị disable\n      this.departmentActive = true\n    },\n    changeDepartment (value) {\n      this.positionActive = true\n      this.emitDepartment()\n    },\n    changePosition (value) {\n      this.emitDepartment()\n    },\n    // thực hiện emit khi có sự thay đổi về dữ liệu\n    emitDepartment () {\n      this.$emit('positionAndDepartment', this.user.departments)\n    },\n    setInitData () {\n      let dataUser = { ...this.dataUser }\n      this.user = { ...this.user, ...dataUser }\n      // nếu mảng dataUser.departments không có gía trị thì push thêm một mảng rỗng\n      if (this.dataUser.departments.data) {\n        this.departmentActive = true\n        this.positionActive = true\n        this.user.departments = this.dataUser.departments.data.length ? this.user.departments.data : [{}]\n      } else {\n        this.user.departments.push({})\n      }\n    }\n  },\n  created () {\n    this.fetchApi({\n      url: 'departments',\n      method: 'GET',\n      params: {\n        limit: -1\n      },\n      success: (response) => {\n        const items = response.data\n        items.forEach(item => {\n          if (!this.departments[item.branch_id]) {\n            this.departments[item.branch_id] = []\n          }\n          this.departments[item.branch_id].push(item)\n        })\n      }\n    })\n    this.getBranchForUser()\n    this.fetchPosition()\n    !!this.dataUser && this.setInitData()\n  }\n}\n</script>\n"],"sourceRoot":"src/views/user"}]}