{"remainingRequest":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/nguyenxuancuong/Sites/hrm_fe/src/views/employeeHrm/Listting.vue?vue&type=style&index=0&id=44064a80&scoped=true&lang=css&","dependencies":[{"path":"/home/nguyenxuancuong/Sites/hrm_fe/src/views/employeeHrm/Listting.vue","mtime":1543214989558},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/postcss-loader/lib/index.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/cache-loader/dist/cjs.js","mtime":1538403001796},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.v-toolbar__content{\n  height: 80px !important;\n}\n.v-menu__content\n{\n  top: 100px !important;\n}\n/*tooltip*/\n",{"version":3,"sources":["Listting.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Listting.vue","sourceRoot":"src/views/employeeHrm","sourcesContent":["<template>\n  <v-layout ref=\"laylout\" column fill-height>\n    <div ref=\"header\">\n      <!-- this.getBranchs({ q: item.branch_name }) -->\n      <v-toolbar height=\"50px\" color=\"white\" flat>\n        <v-layout row wrap>\n          <v-flex xs1 :class=\"isMini && 'max-width-col-2'\">\n            <v-tooltip bottom>\n              <v-btn slot=\"activator\" v-if=\"canAccess('employee.create')\" class=\"mr-3 mt-3\" icon color=\"primary\" @click=\"$router.push({name: 'employee-create-hrm'})\">\n                <v-icon>add</v-icon>\n              </v-btn>\n              <span>Thêm mới</span>\n            </v-tooltip>\n          </v-flex>\n          <!-- v-model=\"params.q\" -->\n          <v-flex xs7 class=\"mt-1\" :class=\"isMini && 'full-flex-basic full-width-col-10'\">\n            <v-text-field\n            hide-details\n            single-line\n            placeholder=\"Nhập tên, sđt, email ...\"\n            v-model=\"filterQ\"\n            @keyup=\"changeSearch\"\n            clearable\n            @click:clear=\"clearSearch\"\n            ></v-text-field>\n          </v-flex>\n          <v-flex xs3 class='mt-1' :class=\"isMini && 'd-none'\">\n            <!-- filter by status -->\n            <v-select\n            class='ml-2'\n            @change=\"filter\"\n            placeholder=\"Trạng thái\"\n            item-text=\"status_txt\"\n            item-value=\"status\"\n            :items=\"statusEmployee\"\n            v-model=\"filterByStatus\"\n            menu-props=\"auto\"\n            hide-details\n            single-line\n            clearable\n            ></v-select>\n          </v-flex>\n          <!--  -->\n          <v-menu\n          :class=\"isMini && 'd-none'\"\n          :close-on-content-click=\"false\"\n          :nudge-width=\"400\"\n          absolute\n          v-model=\"filterMore\"\n          right\n          >\n          <v-btn slot=\"activator\" icon color=\"primary\" class=\"mt-3 ml-4\">\n            <v-icon>list</v-icon>\n          </v-btn>\n          <v-card>\n            <v-list class=\"pa-0\">\n              <v-list-tile avatar>\n                <v-list-tile-content>\n                  <v-list-tile-title class=\"text-xs-center text-bold ml-4\">Lọc nhiều hơn</v-list-tile-title>\n                </v-list-tile-content>\n                <v-list-tile-action>\n                  <v-btn icon @click=\"filterMore = false\">\n                    <v-icon color=\"primary\">close</v-icon>\n                  </v-btn>\n                </v-list-tile-action>\n              </v-list-tile>\n            </v-list>\n            <v-divider></v-divider>\n            <v-flex xs12>\n              <!-- birth_day -->\n              <v-menu\n              ref=\"dateOfBirth\"\n              :close-on-content-click=\"false\"\n              v-model=\"dateOfBirth\"\n              :nudge-right=\"40\"\n              lazy transition=\"scale-transition\"\n              offset-y\n              full-width\n              min-width=\"290px\">\n              <v-text-field\n              style=\"margin-top: 0px;\"\n              class=\"pl-2 pr-2\"\n              placeholder=\"Ngày, tháng, năm sinh\"\n              slot=\"activator\"\n              v-model=\"filterByDateOfBirth\"\n              clearable\n              @click:clear=\"clearDateBirth\"\n              readonly > </v-text-field>\n              <v-date-picker\n              ref=\"picker\"\n              v-model=\"filterByDateOfBirth\"\n              :max=\"new Date().toISOString().substr(0, 10)\"\n              min=\"1950-01-01\"\n              @change=\"save\"> </v-date-picker> </v-menu>\n              <!-- tháng sinh -->\n              <v-select\n              class='pl-2 pr-2'\n              style=\"margin-top: -4px;\"\n              @change=\"filter\"\n              placeholder=\"Tháng sinh\"\n              item-text=\"name\"\n              item-value=\"value\"\n              v-if=\"Array.isArray(monthBirths)\"\n              :items=\"monthBirths\"\n              v-model=\"filterByMonthBirth\"\n              menu-props=\"auto\"\n              hide-details\n              single-line\n              clearable\n              ></v-select>\n              <!-- type contract -->\n              <v-autocomplete\n              class='ml-2 mr-2 mt-3'\n              @change=\"filter\"\n              placeholder=\"Loại hợp đồng\"\n              item-text=\"type_txt\"\n              item-value=\"type\"\n              v-if=\"Array.isArray(contractDetail)\"\n              :items=\"contractDetail\"\n              @keyup=\"sreachContract\"\n              v-model=\"filterByTypeContract\"\n              menu-props=\"auto\"\n              hide-details\n              single-line\n              clearable\n              >\n              <template slot=\"no-data\">\n                <v-list-tile>\n                  <v-list-tile-title style=\"color:blue\">\n                    Không tìm thấy loại hợp đồng\n                  </v-list-tile-title>\n                </v-list-tile>\n              </template>\n            </v-autocomplete>\n            <!-- date First contract -->\n            <v-menu\n            ref=\"dateFirst\"\n            :close-on-content-click=\"false\"\n            v-model=\"dateFirst\"\n            :nudge-right=\"40\"\n            lazy\n            transition=\"scale-transition\"\n            offset-y\n            full-width\n            max-width=\"290px\"\n            min-width=\"290px\"\n            >\n            <v-text-field\n            style=\"margin-top: 17px;\"\n            slot=\"activator\"\n            v-model=\"filterByDateFirstContract\"\n            clearable\n            persistent-hint\n            class='ml-2 mr-2'\n            placeholder=\"Ngày vào công ty\"\n            @click:clear=\"clearDateFirstContract\"\n            ></v-text-field>\n            <v-date-picker @change=\"filter\" v-model=\"filterByDateFirstContract\"\n            no-title @input=\"dateFirst = false\"></v-date-picker>\n          </v-menu>\n        </v-flex>\n      </v-card>\n    </v-menu>\n  </v-layout>\n</v-toolbar>\n<!-- filter by department -->\n<!-- v-if=\"isDepartment\" -->\n<v-toolbar height=\"50px\" color=\"white\" flat :class=\"isMini && 'd-none'\">\n  <v-layout row wrap v-if=\"!isMini\">\n    <v-flex xs4 class=\"pt-0\" :class=\"isMini && 'd-none'\">\n      <v-autocomplete\n      class='ml-2'\n      @change=\"changeBranch\"\n      placeholder=\"Chọn chi nhánh\"\n      :items=\"branchAll\"\n      v-if=\"Array.isArray(branchAll)\"\n      @keyup=\"sreachBranch\"\n      :loading=\"isLoadingBranch\"\n      item-text=\"name\"\n      item-value=\"id\"\n      v-model=\"filterByBranch\"\n      hide-details\n      single-line\n      clearable\n      @click:clear=\"clearBranch\">\n      <template slot=\"no-data\">\n        <v-list-tile>\n          <v-list-tile-title style=\"color:blue\">\n            Không tìm thấy chi nhánh\n          </v-list-tile-title>\n        </v-list-tile>\n      </template>\n    </v-autocomplete>\n  </v-flex>\n  <v-flex xs4 :class=\"isMini && 'd-none'\">\n    <v-autocomplete\n    :disabled = \"!filterByBranch\"\n    class='ml-2'\n    @change=\"ChangeDepartment\"\n    v-if=\"Array.isArray(departmentByBranch)\"\n    placeholder=\"Chọn phòng ban\"\n    :items=\"departmentByBranch\"\n    item-text=\"name\"\n    item-value=\"id\"\n    v-model=\"filterByDepartment\"\n    hide-details\n    single-line\n    clearable\n    @click:clear=\"clearDepartment\"\n    >\n    <template slot=\"no-data\" style=\"color:blue\">\n      <v-list-tile>\n        <v-list-tile-title>\n          Không tìm thấy phòng ban\n        </v-list-tile-title>\n      </v-list-tile>\n      </template\n      >\n    </v-autocomplete>\n  </v-flex>\n  <v-flex xs3 :class=\"isMini && 'd-none'\">\n    <v-autocomplete\n    class='ml-2'\n    @change=\"filter\"\n    placeholder=\"Chọn chức danh\"\n    v-if=\"Array.isArray(positionAll)\"\n    :items=\"positionAll\"\n    :loading=\"isLoadingPosition\"\n    @keyup=\"sreachPosition\"\n    item-text=\"name\"\n    item-value=\"id\"\n    v-model=\"filterByPosition\"\n    hide-details\n    single-line\n    clearable\n    @click:clear=\"filter\"\n    >\n    <template slot=\"no-data\">\n      <v-list-tile>\n        <v-list-tile-title style=\"color:blue\">\n          Không tìm thấy chức danh\n        </v-list-tile-title>\n      </v-list-tile>\n      </template\n      >\n    </v-autocomplete>\n  </v-flex>\n  <v-flex xs1>\n    <v-tooltip bottom>\n      <v-btn class=\"mt-3 ml-4\" slot=\"activator\" icon color=\"primary\" @click=\"resetForm()\">\n        <v-icon>close</v-icon>\n      </v-btn>\n      <span>Reset bộ lọc</span>\n    </v-tooltip>\n  </v-flex>\n</v-layout>\n</v-toolbar>\n<v-toolbar height=\"45px\" color=\"white\" flat v-if=\"!isMini\">\n  <v-layout>\n    <v-flex style=\"flex-basis:55px;\" sm1 class=\"text-bold\">\n      #\n    </v-flex>\n    <v-flex sm1 class=\"text-bold\">\n      Hình ảnh\n    </v-flex>\n    <v-flex sm4 class=\"text-bold\">\n      Thông tin nhân viên\n    </v-flex>\n    <v-flex sm2 class=\"text-bold\">\n      Chi nhánh\n    </v-flex>\n    <v-flex sm2 class=\"text-bold\">\n      Phòng ban\n    </v-flex>\n    <v-flex sm2 class=\"text-bold\">\n      Chức danh\n    </v-flex>\n    <v-flex style=\"flex-basis:100px;\" sm2 class=\"text-bold mr-3\">\n      Hành động\n    </v-flex>\n  </v-layout>\n</v-toolbar>\n</div>\n<v-flex xs12 class=\"border-e0-top\">\n  <data-view\n  :name=\"dataViewName\"\n  api-url=\"employees\"\n  v-if=\"dataViewHeight\"\n  :viewHeight=\"dataViewHeight\"\n  :params=\"filterParams\"\n  :ref=\"dataViewName\"\n  >\n  <template slot-scope=\"{items}\">\n    <v-list three-line>\n      <template  v-for=\"(item, index) in items.data\">\n        <v-list-tile\n        :key=\"'item' + item.id\"\n        avatar\n        @click=\"employeeDetail(item)\"\n        :inactive=\"item.id === $route.params.id\"\n        :class=\"item.id === $route.params.id && 'grey lighten-2'\"\n        >\n        <v-layout class=\"pa-2\">\n          <v-flex style=\"flex-basis:55px;\" sm1 :class=\"isMini && 'd-none'\">\n            {{index + 1}}\n          </v-flex>\n          <v-flex xs1>\n            <v-flex :class=\"isMini && 'd-none'\">\n              <img width=\"80%\" height='60px' :src=\"item.avatar_path\" alt=\"\">\n            </v-flex>\n            <v-flex style=\"margin-top:-10px !important;\">\n              <!-- <b>GT: </b> -->\n            </v-flex>\n          </v-flex>\n          <!-- imfomation -->\n          <v-flex sm4 :class=\"isMini && 'full-flex-basic full-max-width'\">\n            {{ item.name}} -\n            <small>\n              <span style=\"color: green;\">{{ item.gender_txt }}</span>\n            </small>\n              <v-list-tile-sub-title  class=\"text--primary copytext\" v-if=\"item.email\" :class=\"isMini && 'd-none'\">\n                <v-icon size=\"16px\">email</v-icon>\n                <span @click.stop=\"clickToCopy\" class=\"click-copy\">{{ item.email }}</span>\n              </v-list-tile-sub-title>\n              <v-list-tile-sub-title class=\"text--primary copytext\" v-if=\"item.phone\" :class=\"isMini && 'd-none'\">\n                <v-flex :id=\"'phone'+index\"><v-icon size=\"16px\">phone</v-icon>\n                  <span @click.stop=\"clickToCopy\" class=\"click-copy\">{{ item.phone }}</span>\n                </v-flex>\n              </v-list-tile-sub-title>\n            </v-flex>\n            <!-- end infomation -->\n            <v-flex sm2>\n              <v-flex v-if=\"item.departments\" :class=\"isMini && 'd-none'\">\n                <v-flex :key=\"index\" v-for=\"(branch, index) in item.departments.data\" class='pr-2'>\n                  {{ branch.branch_name }}\n                </v-flex>\n              </v-flex>\n            </v-flex>\n            <v-flex sm2 :class=\"isMini && 'd-none'\" >\n              <v-flex v-if=\"item.departments\">\n                <v-flex class=\"pr-2\" :key=\"index\" v-for=\"(department, index) in item.departments.data\">\n                  {{ department.name }}\n                </v-flex>\n              </v-flex>\n            </v-flex>\n            <v-flex sm2 :class=\"isMini && 'd-none'\" >\n              <v-flex v-if=\"item.departments\">\n                <v-flex :key=\"index\" v-for=\"(department, index) in item.departments.data\">\n                  {{ department.position_name }}\n                </v-flex>\n              </v-flex>\n            </v-flex>\n            <v-flex style=\"flex-basis:100px;\" sm2 :class=\"isMini && 'd-none'\">\n             <v-tooltip bottom sm6>\n              <v-btn slot=\"activator\" class=\"ma-0\" v-if=\"canAccess('employee.update')\" icon @click.stop=\"editEmployee(item.id, item)\">\n                <v-icon class='theme--light teal--text'>edit</v-icon>\n              </v-btn>\n              <span>Sửa</span>\n            </v-tooltip>\n            <v-tooltip bottom sm6>\n              <v-btn slot=\"activator\" class=\"ma-0\" v-if=\"canAccess('employee.delete')\" icon @click.stop=\"removeConfirm(item)\">\n                <v-icon class=\"theme--light pink--text\">delete</v-icon>\n              </v-btn>\n              <span>Xóa</span>\n            </v-tooltip>\n            <v-layout row xs12>\n              <v-flex xs6>\n                <v-tooltip bottom>\n                  <v-switch\n                  @click.native.stop\n                  @change=\"changeStatus(item.id)\"\n                  name=\"status\"\n                  slot=\"activator\"\n                  v-model=\"item.status\"\n                  ></v-switch>\n                  <span v-if=\"item.status\">Kích hoạt</span>\n                  <span v-else>Không kích hoạt</span>\n                </v-tooltip>\n              </v-flex>\n              <v-flex xs6 style=\"margin-left: -15px;\">\n                <v-tooltip bottom v-if=\"!item.has_account\">\n                  <v-btn slot=\"activator\" icon  @click.stop=\"addAccount(item)\" style=\"margin-top: 0px;\">\n                    <v-icon color=\"orange\" size=\"15px\">fa-user-plus</v-icon>\n                  </v-btn>\n                  <span> Tạo tài khoản </span>\n                </v-tooltip>\n              </v-flex>\n            </v-layout>\n          </v-flex>\n        </v-layout>\n      </v-list-tile>\n      <v-divider\n      :key=\"'div' + item.id\"\n      v-if=\"index + 1 < items.data.length\"\n      ></v-divider>\n    </template>\n  </v-list>\n</template>\n</data-view>\n</v-flex>\n<dialog-confirm v-model=\"dialogDelete\" @input=\"remove\" />\n<!-- dialog create and edit -->\n<v-dialog v-model=\"dialogAccount\" max-width=\"700px\">\n  <v-form @submit.prevent=\"submitFormAccount\">\n    <v-card class=\"pa-0\">\n      <v-card-title class=\"pa-0 pt-3\">\n        <span class=\"headline\" width=\"100%\"  style=\"margin:0 auto\">Tạo tài khoản: {{ valAccount.email }} </span>\n      </v-card-title>\n        <!-- form edit -->\n      <v-card-text id=\"formSub\" class=\"pt-0\">\n        <v-container grid-list-md class=\"white scroll-y\">\n             <!-- password -->\n          <v-text-field\n          placeholder=\"Nhập mật khẩu\"\n          :error-messages=\"errors.has('password') ? errors.collect('password') : []\"\n          v-validate=\"'required|min:6'\"\n          :data-vv-as=\"$t('label.password')\"\n          :autofocus=\"true\"\n          tabindex=\"1\"\n          ref=\"password\"\n          name=\"password\"\n          :label=\"$t('label.password')\"\n          class=\"input-required\"\n          type=\"password\"\n          v-model=\"accountUser.password\">\n          </v-text-field>\n\n           <!-- password confirm -->\n           <v-text-field\n            tabindex=\"2\"\n            placeholder=\"Nhập lại mật khẩu\"\n            :error-messages=\"errors.has('password_confirmation') ? errors.collect('password_confirmation') : []\"\n            v-validate=\"'required|confirmed:'+accountUser.password\"\n            :data-vv-as=\"$t('label.password_confirmation')\"\n            name=\"password_confirmation\"\n            :label=\"$t('label.password_confirmation')\"\n            class=\"input-required\"\n            type=\"password\"\n            v-model=\"accountUser.password_confirmation\"\n           ></v-text-field>\n        </v-container>\n      </v-card-text>\n       <v-card-actions>\n        <v-spacer></v-spacer>\n        <v-btn tabindex=\"4\" color=\"error\" flat @click.native=\"closeAccount\">Hủy bỏ</v-btn>\n        <v-btn tabindex=\"3\" class=\"green--text\" flat type=\"submit\">Thêm mới</v-btn>\n        <div :tabindex=\"4\"  @focus=\"backTabIndex\"></div>\n      </v-card-actions>\n    </v-card>\n  </v-form>\n</v-dialog>\n</v-layout>\n</template>\n<script>\nimport DialogConfirm from '@/components/DialogConfirm'\nimport { debounce } from 'lodash'\nimport DataView from '@/components/DataView/DataView'\nimport { mapActions, mapGetters } from 'vuex'\nimport { mapFields } from 'vuex-map-fields'\nexport default{\n  name: 'employeeListting',\n  props: {\n    isMini: {\n      type: Boolean,\n      default: false\n    }\n  },\n  components: {\n    DataView,\n    DialogConfirm\n  },\n  data: () => ({\n    copyToText: true,\n    // lọc nhiều hơn\n    filterMore: false,\n    isLoadingBranch: false,\n    isLoadingContract: false,\n    isLoadingPosition: false,\n    // filter by date\n    dialog: false,\n    dialogAccount: false,\n    valAccount: {\n      email: null\n    },\n    accountUser: {\n      password: null,\n      password_confirmation: null\n    },\n    date: null,\n    monthBirths: [\n      { name: 'Tháng một', value: 1 },\n      { name: 'Tháng hai', value: 2 },\n      { name: 'Tháng ba', value: 3 },\n      { name: 'Tháng bốn', value: 4 },\n      { name: 'Tháng năm', value: 5 },\n      { name: 'Tháng sáu', value: 6 },\n      { name: 'Tháng bảy', value: 7 },\n      { name: 'Tháng tám', value: 8 },\n      { name: 'Tháng chín', value: 9 },\n      { name: 'Tháng mười', value: 10 },\n      { name: 'Tháng mười một', value: 11 },\n      { name: 'Tháng mưới hai', value: 12 }\n    ],\n    dateOfBirth: false,\n    // end filter by date\n    branches: [],\n    contracts: [],\n    dateContract: '',\n    positions: [],\n    dialogDelete: false,\n    dateFirst: false,\n    dateExpiration: false,\n    dataViewHeight: 0,\n    dataViewName: 'employee',\n    departments: [],\n    idEmployee: null,\n    dataEmployee: {},\n    employee: {\n      status: true\n    },\n    statusEmployee: [\n      { status_txt: 'Kích hoạt', status: 1 },\n      { status_txt: 'Không kích hoạt', status: 0 }\n    ]\n  }),\n  computed: {\n    ...mapGetters('Department', ['departmentByBranch']),\n    ...mapGetters('Branch', ['branchAll']),\n    ...mapGetters('Employee', ['filterParams']),\n    ...mapGetters('Contracts', ['contractDetail']),\n    ...mapGetters('Position', ['positionAll']),\n    ...mapGetters(['isFetchingApi']),\n    ...mapFields(`Employee`, {\n      filterQ: 'params.q',\n      filterByStatus: 'params.status',\n      filterByBranch: 'params.branchId',\n      filterByDepartment: 'params.departmentId',\n      filterByPosition: 'params.positionId',\n      filterByDateOfBirth: 'params.dateOfBirth',\n      filterByMonthBirth: 'params.monthOfBirth',\n      filterByTypeContract: 'params.contractType',\n      filterByDateFirstContract: 'params.dateOfFirstContract',\n      filterByDateExpirationContract: 'params.dateExpiration'\n    })\n  },\n  watch: {\n    // auto focue when create accoute\n    dialogAccount (val) {\n      if (!val) return\n      requestAnimationFrame(() => {\n        this.$refs.password.focus()\n      })\n    },\n    dateOfBirth (val) {\n      val && this.$nextTick(() => (this.$refs.picker.activePicker = 'YEAR'))\n    },\n    // filterByDateFirstContract (val) {\n    //   this.dateFirst = this.formatDate(this.date)\n    // },\n    filterByDateExpirationContract (val) {\n      this.dateExpiration = this.formatDate(this.date)\n    },\n    filterParams (val) {\n      this.filterParams = val\n    }\n  },\n  methods: {\n    ...mapActions('Dataview', ['removeDataviewEntry', 'updateDataviewEntry', 'setDataview']),\n    ...mapActions('Employee', ['getEmployee', 'deleteEmployee', 'updateStatusEmployee', 'clearFilter', 'clearFilterBranch', 'clearFilterDateBirth', 'clearFilterDateFirstContract']),\n    ...mapActions(['showNotify']),\n    ...mapActions('Department', ['getDepartmentForEmployee']),\n    ...mapActions('Branch', ['getBranchs']),\n    ...mapActions('Contracts', ['fetchContract']),\n    ...mapActions('Position', ['fetchPosition']),\n    ...mapActions('User', ['createUser']),\n    ...mapActions(['fetchApi']),\n    addAccount (valueAccount) {\n      this.$validator.reset()\n      this.accountUser.password = ''\n      this.accountUser.password_confirmation = ''\n      this.valAccount = valueAccount\n      this.dialogAccount = true\n    },\n    // địng dạng hiển thị cho các trường date\n    formatDate (date) {\n      if (!date) return null\n\n      const [year, month, day] = date.split('-')\n      return `${month}/${day}/${year}`\n    },\n    parseDate (date) {\n      if (!date) return null\n\n      const [month, day, year] = date.split('/')\n      return `${day.padStart(2, '0')}-${month.padStart(2, '0')}-${year}`\n    },\n    backTabIndex () {\n      this.$refs.firstInput.focus()\n    },\n    closeAccount () {\n      this.dialogAccount = false\n    },\n    // submit frm account\n    submitFormAccount () {\n      this.accountUser.name = this.valAccount.name\n      this.accountUser.email = this.valAccount.email\n      this.accountUser.phone = this.valAccount.phone\n      this.$validator.validateAll().then(result => {\n        if (result) {\n          this.createUser({\n            user: this.accountUser,\n            cb: (response) => {\n              let object = Object.assign({}, this.valAccount)\n              object.has_account = true\n              this.updateDataviewEntry({\n                name: 'employee',\n                data: object,\n                key: 'id'\n              })\n              this.showNotify({\n                color: 'success',\n                text: this.$t('alert.accountSuccess')\n              })\n              this.setDataview({\n                name: 'user',\n                data: [],\n                uniqueKey: 'id'\n              })\n              this.dialogAccount = false\n            }\n          })\n        }\n      })\n    },\n    employeeDetail (employee) {\n      this.clearFilter()\n      this.filter()\n      this.getEmployee({ employeeId: employee.id, params: { include: 'roles,departments,contracts' } })\n      this.$router.push({ name: 'employee-hrm-detail', params: { id: employee.id } })\n    },\n    save (date) {\n      this.$refs.dateOfBirth.save(date)\n      this.filter()\n    },\n    clearSearch () {\n      this.changeSearch()\n      this.filter()\n    },\n    clearDepartment () {\n      this.changeSearch()\n    },\n    clearBranch () {\n      this.getBranchs({ params: { limit: 10 } })\n      this.clearFilterBranch()\n      this.changeSearch()\n    },\n    clearDateBirth () {\n      this.clearFilterDateBirth()\n      this.changeSearch()\n    },\n    clearDateFirstContract () {\n      this.clearFilterDateFirstContract()\n      this.changeSearch()\n    },\n    resetForm () {\n      this.clearFilter()\n      this.filter()\n    },\n    changeSearch: debounce(function () {\n      this.filter()\n    }, 200),\n    // tìm kiếm chi nhánh\n    sreachBranch: debounce(function (value) {\n      this.isLoadingBranch = true\n      this.getBranchs({ params: { q: value.target.value, limit: 10 } })\n      setTimeout(() => {\n        this.isLoadingBranch = false\n      }, 500)\n    }, 500),\n    // tìm kiếm hợp đồng\n    sreachContract: debounce(function (value) {\n      this.isLoadingContract = true\n      this.fetchContract({ params: { q: value.target.value, limit: 10 } })\n      setTimeout(() => {\n        this.isLoadingContract = false\n      }, 500)\n    }, 500),\n    // tìm kiếm phòng ban\n    sreachPosition: debounce(function (value) {\n      this.isLoadingPosition = true\n      this.fetchPosition({ params: { q: value.target.value, limit: 10 } })\n      setTimeout(() => {\n        this.isLoadingPosition = false\n      }, 200)\n    }, 500),\n    // lọc phòng ban theo chi nhánh\n    changeBranch: debounce(function (value) {\n      if (value) {\n        this.getDepartmentForEmployee({\n          branchId: value,\n          params: { include: 'departments' },\n          cb: () => {\n            this.departments = this.departmentByBranch\n          }\n        })\n      }\n      this.filter()\n    }, 500),\n    ChangeDepartment: debounce(function () {\n      this.placeholderPosition = 'Chọn chức vụ'\n      this.filter()\n    }, 500),\n    filter () {\n      this.$refs[this.dataViewName].$emit('reload')\n    },\n    changeStatus (idEmployee) {\n      this.updateStatusEmployee({\n        id: idEmployee,\n        employee: this.employee,\n        cb: (response) => {\n          this.$store.dispatch('showNotify', {\n            text: this.$t('alert.statusSuccess'),\n            color: 'success'\n          })\n        },\n        error: (error) => {\n          if (error.status === 404) {\n            this.$store.dispatch('showNotify', {\n              text: this.$t('alert.not-found'),\n              color: 'warning'\n            })\n          }\n        }\n      })\n    },\n    openDialog () {\n      this.dialog = true\n    },\n    close () {\n      this.dialog = false\n    },\n    editEmployee (employeeId, item) {\n      this.getEmployee({ employeeId: employeeId, params: { include: 'roles,departments.branch,contracts' } })\n      this.$router.push({ name: 'employee-hrm-edit', params: { id: employeeId } })\n    },\n    // xóa employee\n    removeConfirm (item) {\n      // this.idEmployee = id\n      this.dataEmployee = item\n      this.dialogDelete = true\n    },\n    remove (confirm) {\n      if (confirm) {\n        this.deleteEmployee({\n          id: this.dataEmployee.id,\n          cb: (response) => {\n            this.removeDataviewEntry({\n              name: 'employee',\n              data: this.dataEmployee,\n              key: 'id'\n            })\n            this.$store.dispatch('showNotify', {\n              text: this.$t('alert.deleteEmployeeSuccess'),\n              color: 'success'\n            })\n            this.dialogDelete = false\n          },\n          error: (error) => {\n            if (error.status === 404) {\n              this.$store.dispatch('showNotify', {\n                text: this.$t('alert.not-found'),\n                color: 'warning'\n              })\n            }\n          }\n        })\n      }\n    }\n  },\n  mounted () {\n    // if (!this.branchAll.length) {\n    this.getBranchs({ params: { limit: 10 } })\n    // }\n    // if (!this.contractDetail.length) {\n    this.fetchContract({ params: { limit: 10 } })\n    // }\n    // if (!this.positionAll.length) {\n    this.fetchPosition({ params: { limit: 10 } })\n    // }\n    if (this.$route.params.id) {\n      this.dataViewHeight = this.$refs.laylout.clientHeight - 55\n    } else {\n      this.dataViewHeight = this.$refs.laylout.clientHeight - 147\n    }\n    let query = { ...this.$route.query }\n    if (query.hasOwnProperty('reload')) {\n      this.$nextTick(() => {\n        this.$refs[this.dataViewName].$emit('reload')\n      })\n      delete query.reload\n      this.$router.replace({\n        query: query\n      })\n    }\n  }\n}\n</script>\n<style scoped>\n.v-toolbar__content{\n  height: 80px !important;\n}\n.v-menu__content\n{\n  top: 100px !important;\n}\n/*tooltip*/\n</style>\n<style>\n.copytext{\n  overflow: unset;\n}\n</style>\n"]}]}