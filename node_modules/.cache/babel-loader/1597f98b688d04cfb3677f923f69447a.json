{"remainingRequest":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/babel-loader/lib/index.js!/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/nguyenxuancuong/Sites/hrm_fe/src/views/plans/Form.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/nguyenxuancuong/Sites/hrm_fe/src/views/plans/Form.vue","mtime":1543377608179},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/cache-loader/dist/cjs.js","mtime":1538403001796},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/@babel/runtime/helpers/builtin/es6/asyncToGenerator\";\nimport _slicedToArray from \"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/@babel/runtime/helpers/builtin/es6/slicedToArray\";\nimport _objectSpread from \"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/@babel/runtime/helpers/builtin/es6/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from 'axios';\nimport formsub from './Form_sub';\nimport DialogConfirm from '@/components/DialogConfirm';\nimport { mapGetters, mapActions } from 'vuex';\nexport default {\n  name: 'PlanForm',\n  components: {\n    formsub: formsub,\n    DialogConfirm: DialogConfirm\n  },\n  computed: _objectSpread({}, mapGetters(['isFetchingApi']), {\n    isCreate: function isCreate() {\n      return this.type === 'create';\n    }\n  }),\n  props: {\n    type: {\n      type: String,\n      default: 'create'\n    },\n    dataPlan: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    }\n  },\n  data: function data() {\n    return {\n      dateStart: false,\n      dateEnd: false,\n      plan: {\n        title: '',\n        content: '',\n        status: 0,\n        date_start: null,\n        date_end: null,\n        details: []\n      },\n      status: [{\n        'id': 0,\n        'name': 'Mới'\n      }, {\n        'id': 1,\n        'name': 'Chờ duyệt'\n      }, {\n        'id': 2,\n        'name': 'Đã duyệt'\n      }, {\n        'id': 3,\n        'name': 'Không duyệt'\n      }, {\n        'id': 4,\n        'name': 'Hoàn thành'\n      }, {\n        'id': 5,\n        'name': 'Hủy'\n      }]\n    };\n  },\n  watch: {\n    dataPlan: function dataPlan() {\n      this.setInitData();\n    },\n    dateStart: function dateStart(val) {\n      this.plan.date_start = this.formatDate(this.plan.date_start);\n    },\n    dateEnd: function dateEnd(val) {\n      this.plan.date_end = this.formatDate(this.plan.date_end);\n    }\n  },\n  methods: _objectSpread({}, mapActions(['fetchApi']), {\n    setEditorContent: function setEditorContent(e, content) {\n      e.setContent(content || '');\n    },\n    formatDate: function formatDate(date) {\n      if (!date) return null;\n\n      var _date$split = date.split('-'),\n          _date$split2 = _slicedToArray(_date$split, 3),\n          year = _date$split2[0],\n          month = _date$split2[1],\n          day = _date$split2[2];\n\n      return \"\".concat(year, \"-\").concat(month, \"-\").concat(day);\n    },\n    save: function save(date) {\n      this.$refs.dateEnd.save(date);\n    },\n    dateStarts: function dateStarts() {\n      var today = new Date();\n      var dd = today.getDate();\n      var mm = today.getMonth() + 1;\n      var yyyy = today.getFullYear();\n\n      if (dd < 10) {\n        dd = '0' + dd;\n      }\n\n      if (mm < 10) {\n        mm = '0' + mm;\n      }\n\n      today = yyyy + '-' + mm + '-' + dd;\n      this.plan.date_start = today;\n    },\n    // thời gian kết thúc\n    dateEnds: function dateEnds() {\n      var today = new Date();\n      var dd = today.getDate();\n      var mm = today.getMonth() + 3;\n      var yyyy = today.getFullYear();\n\n      if (dd < 10) {\n        dd = '0' + dd;\n      }\n\n      if (mm < 10) {\n        mm = '0' + mm;\n      }\n\n      today = yyyy + '-' + mm + '-' + dd;\n      this.plan.date_end = today;\n    },\n    handleImageAdded: function () {\n      var _handleImageAdded = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(file, success, failure) {\n        var formData, response;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                formData = new FormData();\n                formData.append('file', file.blob());\n                _context.prev = 2;\n                _context.next = 5;\n                return axios.post('/blogs/upload', formData);\n\n              case 5:\n                response = _context.sent;\n\n                if (!(response.data.code === 1)) {\n                  _context.next = 10;\n                  break;\n                }\n\n                success(response.data.data.path);\n                _context.next = 11;\n                break;\n\n              case 10:\n                return _context.abrupt(\"return\", false);\n\n              case 11:\n                _context.next = 16;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](2);\n\n                if (_context.t0.status === 422) {\n                  this.$store.dispatch('showNotify', {\n                    text: this.$t('alert.error'),\n                    color: 'error'\n                  });\n                }\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[2, 13]]);\n      }));\n\n      return function handleImageAdded(_x, _x2, _x3) {\n        return _handleImageAdded.apply(this, arguments);\n      };\n    }(),\n    validateBeforeSubmit: function validateBeforeSubmit() {\n      var _this = this;\n\n      this.$refs.formSub.validateBeforeSubmit();\n      this.$validator.validateAll().then(function (result) {\n        if (result) {\n          var submitData = _objectSpread({}, _this.plan);\n\n          _this.$emit('submit', submitData);\n        } else {\n          _this.$store.dispatch('showNotify', {\n            text: _this.$t('alert.invalid'),\n            color: 'warning'\n          });\n        }\n      });\n    },\n    positionAndDepartment: function positionAndDepartment(updated) {\n      this.plan.details = updated;\n    },\n    setInitData: function setInitData() {\n      var dataPlan = _objectSpread({}, this.dataPlan);\n\n      this.plan = _objectSpread({}, this.plan, dataPlan);\n\n      if (this.plan.details.data) {\n        this.plan.details.data.map(function (item) {\n          if (item.department) {\n            if (item.department.data.branch) {\n              item.branchs = [item.department.data.branch.data];\n              item.positions = [{\n                'id': item.position_id,\n                'name': item.position_txt\n              }];\n            }\n          }\n\n          return item;\n        });\n      }\n    }\n  }),\n  created: function created() {\n    this.dateEnds();\n    this.dateStarts();\n    !!this.dataPlan && this.setInitData();\n  }\n};",{"version":3,"sources":["Form.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <v-form @submit.prevent=\"validateBeforeSubmit\">\n    <v-container fluid style=\"position:relative\">\n      <v-layout row>\n        <v-flex xs6>\n          <v-text-field\n            tabindex=\"1\"\n            class=\"input-required\"\n            :error-messages=\"errors.has('title') ? errors.collect('title') : []\"\n            v-validate=\"'required|min:3'\"\n            :data-vv-as=\"$t('label.title')\"\n            name=\"title\"\n            placeholder=\"Tiêu đề\"\n            autofocus\n            :label=\"$t('label.title')\"\n            v-model=\"plan.title\">\n          </v-text-field>\n\n          <template>\n            <v-menu\n              class=\"input-required\"\n              ref=\"dateStart\"\n              :close-on-content-click=\"false\"\n              v-model=\"dateStart\"\n              :nudge-right=\"40\"\n              lazy transition=\"scale-transition\"\n              offset-y\n              full-width\n              min-width=\"290px\">\n              <v-text-field\n                tabindex=\"3\"\n                placeholder=\"Nhập ngày bắt đầu\"\n                slot=\"activator\"\n                v-model=\"plan.date_start\"\n                label=\"Ngày bắt đầu\"\n                readonly></v-text-field>\n              <v-date-picker\n                v-model=\"plan.date_start\"\n                :min=\"new Date().toISOString().substr(0, 10)\"\n                no-title @input=\"dateStart = false\"\n              ></v-date-picker>\n            </v-menu>\n          </template>\n        </v-flex>\n\n        <v-flex xs6>\n          <v-select\n            tabindex=\"2\"\n            :items=\"status\"\n            :disabled=\"isCreate\"\n            v-model=\"plan.status\"\n            item-text=\"name\"\n            item-value=\"id\"\n            name=\"status\"\n            :label=\"$t('label.status')\"\n          ></v-select>\n\n          <template>\n            <v-menu\n              class=\"input-required\"\n              ref=\"dateEnd\"\n              :close-on-content-click=\"false\"\n              v-model=\"dateEnd\"\n              :nudge-right=\"40\"\n              lazy transition=\"scale-transition\"\n              offset-y\n              full-width\n              min-width=\"290px\">\n              <v-text-field\n                tabindex=\"4\"\n                placeholder=\"Nhập ngày kết thúc\"\n                slot=\"activator\"\n                v-model=\"plan.date_end\"\n                label=\"Ngày kết thúc\"\n                readonly></v-text-field>\n              <v-date-picker\n                v-model=\"plan.date_end\"\n                :min=\"new Date().toISOString().substr(0, 10)\"\n                no-title @input=\"dateEnd = false\"\n              ></v-date-picker>\n            </v-menu>\n          </template>\n        </v-flex>\n      </v-layout>\n\n      <v-layout row wrap>\n        <v-flex xs12>\n          <label style=\"color:#67757c; font-size: 16px; margin-bottom: 3px\">Nội dung</label>\n          <tinymce\n            id=\"d1\"\n            tabindex=\"5\"\n            class=\"mr-1\"\n            v-model=\"plan.content\"\n            :other_options=\"{ height: '300px', images_upload_handler: handleImageAdded }\"\n            placeholder=\"Nhập nội dung\"\n            :error-messages=\"errors.has('content') ? errors.collect('content') : []\"\n            :data-vv-as=\"$t('label.content')\"\n            name=\"content\"\n            @editorInit=\"setEditorContent($event, plan.content)\"\n            :label=\"$t('label.content')\"\n          ></tinymce>\n        </v-flex>\n\n        <!-- form sub -->\n        <!--  khi create -->\n      </v-layout>\n      <formsub\n        ref=\"formSub\"\n        :dataPlan=\"plan\"\n        v-on:positionAndDepartment=\"positionAndDepartment($event)\">\n      </formsub>\n      <v-layout>\n        <v-flex xs12 text-xs-center>\n          <v-btn\n            :loading=\"isFetchingApi\"\n            :disabled=\"isFetchingApi\"\n            color=\"primary\"\n            type=\"submit\">\n            <template v-if=\"isCreate\">\n              <v-icon left>add</v-icon>\n              {{$t('control.create')}}\n            </template>\n            <template v-else>\n              <v-icon left>save</v-icon>\n              {{$t('control.save')}}\n            </template>\n          </v-btn>\n        </v-flex>\n      </v-layout>\n    </v-container>\n  </v-form>\n</template>\n<script>\nimport axios from 'axios'\nimport formsub from './Form_sub'\nimport DialogConfirm from '@/components/DialogConfirm'\nimport { mapGetters, mapActions } from 'vuex'\nexport default {\n  name: 'PlanForm',\n  components: {\n    formsub,\n    DialogConfirm\n  },\n  computed: {\n    ...mapGetters(['isFetchingApi']),\n    isCreate () {\n      return this.type === 'create'\n    }\n  },\n  props: {\n    type: {\n      type: String,\n      default: 'create'\n    },\n    dataPlan: {\n      type: Object,\n      default: () => {\n        return {}\n      }\n    }\n  },\n  data () {\n    return {\n      dateStart: false,\n      dateEnd: false,\n      plan: {\n        title: '',\n        content: '',\n        status: 0,\n        date_start: null,\n        date_end: null,\n        details: []\n      },\n      status: [\n        { 'id': 0, 'name': 'Mới' },\n        { 'id': 1, 'name': 'Chờ duyệt' },\n        { 'id': 2, 'name': 'Đã duyệt' },\n        { 'id': 3, 'name': 'Không duyệt' },\n        { 'id': 4, 'name': 'Hoàn thành' },\n        { 'id': 5, 'name': 'Hủy' }\n      ]\n    }\n  },\n  watch: {\n    dataPlan () {\n      this.setInitData()\n    },\n    dateStart (val) {\n      this.plan.date_start = this.formatDate(this.plan.date_start)\n    },\n    dateEnd (val) {\n      this.plan.date_end = this.formatDate(this.plan.date_end)\n    }\n  },\n\n  methods: {\n    ...mapActions(['fetchApi']),\n    setEditorContent (e, content) {\n      e.setContent(content || '')\n    },\n    formatDate (date) {\n      if (!date) return null\n      const [year, month, day] = date.split('-')\n      return `${year}-${month}-${day}`\n    },\n    save (date) {\n      this.$refs.dateEnd.save(date)\n    },\n    dateStarts () {\n      let today = new Date()\n      let dd = today.getDate()\n      let mm = today.getMonth() + 1\n      let yyyy = today.getFullYear()\n      if (dd < 10) {\n        dd = '0' + dd\n      }\n      if (mm < 10) {\n        mm = '0' + mm\n      }\n      today = yyyy + '-' + mm + '-' + dd\n      this.plan.date_start = today\n    },\n    // thời gian kết thúc\n    dateEnds () {\n      let today = new Date()\n      let dd = today.getDate()\n      let mm = today.getMonth() + 3\n      let yyyy = today.getFullYear()\n      if (dd < 10) {\n        dd = '0' + dd\n      }\n      if (mm < 10) {\n        mm = '0' + mm\n      }\n      today = yyyy + '-' + mm + '-' + dd\n      this.plan.date_end = today\n    },\n    handleImageAdded: async function (file, success, failure) {\n      let formData = new FormData()\n      formData.append('file', file.blob())\n      try {\n        let response = await axios.post('/blogs/upload', formData)\n        if (response.data.code === 1) {\n          success(response.data.data.path)\n        } else {\n          return false\n        }\n      } catch (err) {\n        if (err.status === 422) {\n          this.$store.dispatch('showNotify', {\n            text: this.$t('alert.error'),\n            color: 'error'\n          })\n        }\n      }\n    },\n    validateBeforeSubmit () {\n      this.$refs.formSub.validateBeforeSubmit()\n      this.$validator.validateAll().then(result => {\n        if (result) {\n          let submitData = { ...this.plan }\n          this.$emit('submit', submitData)\n        } else {\n          this.$store.dispatch('showNotify', {\n            text: this.$t('alert.invalid'),\n            color: 'warning'\n          })\n        }\n      })\n    },\n    positionAndDepartment (updated) {\n      this.plan.details = updated\n    },\n    setInitData () {\n      let dataPlan = { ...this.dataPlan }\n      this.plan = { ...this.plan, ...dataPlan }\n      if (this.plan.details.data) {\n        this.plan.details.data.map((item) => {\n          if (item.department) {\n            if (item.department.data.branch) {\n              item.branchs = [item.department.data.branch.data]\n              item.positions = [\n                {\n                  'id': item.position_id,\n                  'name': item.position_txt\n                }\n              ]\n            }\n          }\n          return item\n        })\n      }\n    }\n\n  },\n  created () {\n    this.dateEnds()\n    this.dateStarts()\n    !!this.dataPlan && this.setInitData()\n  }\n}\n</script>\n<style scoped>\n  iframe {\n    height: 300px !important;\n  }\n</style>\n"],"sourceRoot":"src/views/plans"}]}