{"remainingRequest":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/nguyenxuancuong/Sites/hrm_fe/src/views/contracts/Form.vue?vue&type=style&index=0&id=c66bcfa8&scoped=true&lang=css&","dependencies":[{"path":"/home/nguyenxuancuong/Sites/hrm_fe/src/views/contracts/Form.vue","mtime":1543150409630},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/postcss-loader/lib/index.js","mtime":499162500000},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/cache-loader/dist/cjs.js","mtime":1538403001796},{"path":"/home/nguyenxuancuong/Sites/hrm_fe/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  .marTop-22{\n   margin-top: -22px !important;\n }\n .marButton-22{\n  margin-bottom: 22px !important;\n}\n.paddingContainer{\n  padding: 0px 24px 24px 24px !important\n}\n",{"version":3,"sources":["Form.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Form.vue","sourceRoot":"src/views/contracts","sourcesContent":["    <template class=\"paddingContainer\">\n      <v-form @submit.prevent=\"validateBeforeSubmit\">\n        <v-container fluid class=\"paddingContainer\">\n          <v-layout row wrap class=\"marTop-22\">\n            <v-flex xs6 class=\"pr-2\">\n              <!-- title contract -->\n              <v-text-field\n              placeholder=\"Nhập tiêu đề hợp đồng\"\n              :error-messages=\"errors.has('title_contract') ? errors.collect('title_contract') : []\"\n              v-validate=\"'required'\"\n              :data-vv-as=\"$t('label.title_contract')\"\n              ref=\"firstInput\"\n              :tabindex=\"1\"\n              :label=\"$t('label.title_contract')\"\n              class=\"input-required\"\n              name=\"title_contract\"\n             autofocus=\"autofocus\"\n              v-model=\"contract.title\"> </v-text-field>\n              <!-- type contract -->\n            </v-flex>\n            <v-flex xs6 class=\"pr-2\">\n             <v-autocomplete\n             v-model=\"contract.employee_id\"\n             :items=\"listtingEmployee\"\n             v-if=\"Array.isArray(listtingEmployee)\"\n             @keyup=\"sreachEmployee\"\n             @click:clear=\"clearContract\"\n             @blur=\"closeBlur()\"\n             :error-messages=\"errors.has('user_id') ? errors.collect('user_id') : []\"\n             v-validate=\"'required'\"\n             :item-text=\"twoparams\"\n             clearable\n             item-value=\"id\"\n             placeholder=\"Chọn tên nhân viên\"\n             :label=\"$t('label.user_id')\"\n             class=\"input-required\"\n             :data-vv-as=\"$t('label.user_id')\"\n             name=\"user_id\"\n             :loading=\"isLoadingEmployee\"\n             :tabindex=\"2\"\n            >\n              <template slot=\"no-data\">\n              <v-list-tile>\n                <v-list-tile-title style=\"color: blue\">\n                  Không có tên nhân viên trong hệ thống\n                </v-list-tile-title>\n              </v-list-tile>\n            </template>\n              <template slot=\"item\" slot-scope=\"{ item }\" >\n                  {{ item.name }} - {{ item.phone }}\n              </template>\n            </v-autocomplete>\n         </v-flex>\n       </v-layout>\n       <v-layout row wrap class=\"marTop-22\">\n        <v-flex xs6>\n         <v-select\n         v-validate=\"'required'\"\n         :error-messages=\"errors.has('status') ? errors.collect('status') : []\"\n         :data-vv-as=\"$t('label.status')\"\n         name=\"status\"\n         :label=\"$t('label.status')\"\n         v-model=\"contract.status\"\n         :items=\"status\"\n         item-value=\"id\"\n         item-text=\"name\"\n         :tabindex=\"3\"\n        >\n       </v-select>\n     </v-flex>\n     <v-flex xs6>\n      <v-select\n      v-validate=\"'required'\"\n      :error-messages=\"errors.has('type') ? errors.collect('type') : []\"\n      :data-vv-as=\"$t('label.type')\"\n      name=\"type\"\n      :label=\"$t('label.type')\"\n      v-model=\"contract.type\"\n      :items=\"types\"\n      item-value=\"id\"\n      item-text=\"name\"\n      :tabindex=\"4\"\n      > </v-select>\n      <!-- status contract-->\n    </v-flex>\n  </v-layout>\n\n  <v-layout row wrap class=\"marTop-22\">\n    <v-flex xs6>\n      <!-- date_sign -->\n      <v-menu\n      ref=\"sign\"\n      :close-on-content-click=\"false\"\n      v-model=\"sign\"\n      :nudge-right=\"40\"\n      :return-value.sync=\"contract.date_sign\"\n      lazy\n      transition=\"scale-transition\"\n      offset-y\n      full-width\n      min-width=\"290px\"\n      >\n      <v-text-field\n      slot=\"activator\"\n      v-model=\"contract.date_sign\"\n      label=\"Ngày ký\"\n      :tabindex=\"5\"\n      readonly\n      ></v-text-field>\n      <v-date-picker v-model=\"contract.date_sign\" no-title scrollable>\n        <v-spacer></v-spacer>\n        <v-btn flat color=\"primary\" @click=\"sign = false\">Cancel</v-btn>\n        <v-btn flat color=\"primary\" @click=\"$refs.sign.save(contract.date_sign)\">OK</v-btn>\n      </v-date-picker>\n    </v-menu>\n  </v-flex>\n\n  <v-flex xs6>\n   <!--date_expiration-->\n        <v-menu\n      ref=\"expiration\"\n      :close-on-content-click=\"false\"\n      v-model=\"expiration\"\n      :nudge-right=\"40\"\n      :return-value.sync=\"contract.date_expiration\"\n      lazy\n      transition=\"scale-transition\"\n      offset-y\n      full-width\n      min-width=\"290px\"\n      >\n      <v-text-field\n      slot=\"activator\"\n      v-model=\"contract.date_expiration\"\n      label=\"Ngày hết hạn\"\n      :tabindex=\"6\"\n      readonly\n      ></v-text-field>\n      <v-date-picker v-model=\"contract.date_expiration\" no-title scrollable>\n        <v-spacer></v-spacer>\n        <v-btn flat color=\"primary\" @click=\"expiration = false\">Cancel</v-btn>\n        <v-btn flat color=\"primary\" @click=\"$refs.expiration.save(contract.date_expiration)\">OK</v-btn>\n      </v-date-picker>\n    </v-menu>\n</v-flex>\n</v-layout>\n\n<v-layout row wrap class=\"marTop-22 marButton-22\">\n  <v-flex xs6>\n    <!-- date_effective -->\n      <v-menu\n      ref=\"effective\"\n      :close-on-content-click=\"false\"\n      v-model=\"effective\"\n      :nudge-right=\"40\"\n      :return-value.sync=\"contract.date_effective\"\n      lazy\n      transition=\"scale-transition\"\n      offset-y\n      full-width\n      min-width=\"290px\"\n      >\n      <v-text-field\n      slot=\"activator\"\n      v-model=\"contract.date_effective\"\n      :tabindex=\"7\"\n      label=\"Ngày  hiệu lực\"\n      readonly\n      ></v-text-field>\n      <v-date-picker v-model=\"contract.date_effective\" no-title scrollable>\n        <v-spacer></v-spacer>\n        <v-btn flat color=\"primary\" @click=\"effective = false\">Cancel</v-btn>\n        <v-btn flat color=\"primary\" @click=\"$refs.effective.save(contract.date_effective)\">OK</v-btn>\n      </v-date-picker>\n    </v-menu>\n  </v-flex>\n  <v-flex xs6>\n   <v-text-field\n   v-validate=\"'url:require_protocol'\"\n  :error-messages=\"errors.has('link_contract') ? errors.collect('link_contract') : []\"\n   placeholder=\"Nhập link hợp đồng\"\n   :data-vv-as=\"$t('label.link_contract')\"\n   :tabindex=\"8\"\n   :label=\"$t('label.link_contract')\"\n   name=\"link_contract\"\n   v-model=\"contract.link\"> </v-text-field>\n </v-flex>\n</v-layout>\n<v-flex xs12 text-xs-center class=\"marTop-22\">\n  <v-btn\n  :loading=\"isFetchingApi\"\n  :disabled=\"isFetchingApi\"\n  :tabindex=\"9\"\n  color=\"primary\"\n  type=\"submit\"\n  >\n  <template v-if=\"isCreate\">\n    <v-icon left>add</v-icon> {{$t('control.create')}}\n  </template>\n  <template v-else>\n    <v-icon left>save</v-icon> {{$t('control.save')}}\n  </template>\n</v-btn>\n<div :tabindex=\"10\"  @focus=\"backTabIndex\"></div>\n</v-flex>\n</v-container>\n</v-form>\n</template>\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nimport moment from 'moment'\nexport default{\n  name: 'ContractForm',\n  computed: {\n    ...mapGetters(['isFetchingApi']),\n    ...mapGetters('Employee', ['employeeAll']),\n    ...mapActions('Contracts', ['getContract']),\n    ...mapGetters('Contracts', ['contractDetail']),\n    isCreate () {\n      return this.type === 'create'\n    }\n  },\n  props: {\n    type: {\n      type: String,\n      default: 'create'\n    },\n    dataContract: {\n      type: Object,\n      default: () => {\n        return {}\n      }\n    }\n  },\n  data () {\n    return {\n      menu: null,\n      sign: null,\n      expiration: null,\n      effective: null,\n      isLoadingEmployee: false,\n      dateSign: false,\n      dateEffective: false,\n      listtingEmployee: [],\n      dateExpiration: false,\n      contract: {\n        code: '',\n        title: '',\n        type: 0,\n        status: 0,\n        date_sign: '',\n        date_effective: '',\n        date_expiration: '',\n        employee_id: '',\n        link: ''\n      },\n      types: [\n        { 'id': 0, 'name': 'Học việc' },\n        { 'id': 1, 'name': 'Cộng tác viên' },\n        { 'id': 2, 'name': 'Thử việc' },\n        { 'id': 3, 'name': 'Có thời hạn' },\n        { 'id': 4, 'name': 'Không thời hạn' },\n        { 'id': 5, 'name': 'Khác' }\n      ],\n      status: [\n        { 'id': 0, 'name': 'Tiêu chuẩn' },\n        { 'id': 1, 'name': 'Chấm dứt' },\n        { 'id': 2, 'name': 'Gia hạn' }\n      ]\n    }\n  },\n  watch: {\n    dataContract (value) {\n      this.setInitData()\n      // mặc định lấy 10 bản ghi\n      console.log('data value ', value)\n      if (value.id) {\n        // this.getEmployees({ params: { q: value.employee_name, limit: 10 } })\n        this.listtingEmployee.push(value.employee.data)\n      }\n    },\n    dateSign (val) {\n      val && this.$nextTick(() => (this.$refs.picker.activePicker = 'YEAR'))\n    },\n    dateEffective (val) {\n      val && this.$nextTick(() => (this.$refs.picker.activePicker = 'YEAR'))\n    },\n    dateExpiration (val) {\n      val && this.$nextTick(() => (this.$refs.picker.activePicker = 'YEAR'))\n    }\n\n  },\n  methods: {\n    ...mapActions(['fetchApi']),\n    ...mapActions('Employee', ['getEmployees', 'setEmployee', 'getEmployeesForm']),\n    clearContract () {\n      // this.getEmployees({ params: { limit: 10 } })\n      this.getEmployeesForm({\n        params: { limit: 10 },\n        cb: (params) => {\n          this.listtingEmployee = params\n        }\n      })\n    },\n\n    closeBlur () {\n      if (this.contract.id && this.contract.employee_id !== this.contract.employee.data.id) {\n        console.log('co thay doi')\n      } else if (this.contract.employee && this.contract.id) {\n        console.log('set data employees')\n        // this.setEmployee({\n        //   employees: [this.contract.employee.data]\n        // })\n        this.listtingEmployee.push(this.contract.employee.data)\n        //  console.log(\"data employee 1:\",this.contract.employee.data);\n        // console.log(\"data employee :\",  this.employeeAll);\n      }\n    },\n    // Passes 2 parameters to item text selectbox\n    twoparams (item) {\n      return item.name + ' - ' + item.phone\n    },\n    // screach employee\n    sreachEmployee (value) {\n      this.getEmployeesForm({\n        params: { q: value.target.value, limit: 10 },\n        cb: (params) => {\n          this.listtingEmployee = params\n        }\n\n      })\n      this.isLoadingEmployee = true\n      setTimeout(() => {\n        this.isLoadingEmployee = false\n      }, 1000)\n    },\n    // autofocus firsrtInput\n    backTabIndex () {\n      this.$refs.firstInput.focus()\n    },\n    // save date\n    save (date) {\n      this.$refs.dateSign.save(date)\n      this.$refs.dateEffective.save(date)\n      this.$refs.dateExpiration.save(date)\n    },\n    // thời gian đăng kí , có hiệu lực hợp đồng\n    dateConstract () {\n      let today = moment().format('YYYY-MM-DD')\n      this.contract.date_sign = today\n      this.contract.date_effective = today\n      this.contract.date_expiration = today\n    },\n    // thời gian kết thúc hợp đồng\n    dateExpirationConstract () {\n      let today = new Date()\n      let dd = today.getDate()\n      let mm = today.getMonth() + 3\n      let yyyy = today.getFullYear()\n      if (dd < 10) {\n        dd = '0' + dd\n      }\n      if (mm < 10) {\n        mm = '0' + mm\n      }\n      today = yyyy + '-' + mm + '-' + dd\n      this.contract.date_expiration = today\n    },\n    setInitData () {\n      let dataContract = { ...this.dataContract }\n      this.contract = { ...this.contract, ...dataContract }\n      if (this.$route.params.id) {\n        this.listtingEmployee.push(this.contract.employee.data)\n      }\n    },\n    // validator form\n    validateBeforeSubmit () {\n      this.$validator.validateAll().then(result => {\n        if (result) {\n          console.log('data validateBeforeSubmit :', result)\n          this.$emit('submit', this.contract)\n        } else {\n          this.$store.dispatch('showNotify', {\n            text: this.$t('alert.invalid'),\n            color: 'warning'\n          })\n        }\n      })\n    }\n  },\n  mounted () {\n    if (!this.listtingEmployee.length && !this.$route.params.id) {\n      this.getEmployeesForm({\n        params: { limit: 10 },\n        cb: (params) => {\n          this.listtingEmployee = params\n        }\n      })\n    }\n  },\n  created () {\n    this.dateExpirationConstract()\n    this.dateConstract()\n    !!this.dataContract && this.setInitData()\n  }\n}\n</script>\n<style scoped>\n  .marTop-22{\n   margin-top: -22px !important;\n }\n .marButton-22{\n  margin-bottom: 22px !important;\n}\n.paddingContainer{\n  padding: 0px 24px 24px 24px !important\n}\n</style>\n"]}]}